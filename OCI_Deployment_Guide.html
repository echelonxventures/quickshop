<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuickShop E-commerce Platform - Complete Deployment Guide</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            background-color: #fff;
        }
        .header {
            text-align: center;
            border-bottom: 3px solid #2c3e50;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        h2 {
            color: #3498db;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
            margin-top: 30px;
        }
        h3 {
            color: #2c3e50;
            margin-top: 25px;
        }
        h4 {
            color: #7f8c8d;
        }
        code {
            background-color: #f8f9fa;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            color: #e74c3c;
            border: 1px solid #e9ecef;
        }
        pre {
            background-color: #2c3e50;
            color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            border-left: 4px solid #3498db;
        }
        pre code {
            background: none;
            color: inherit;
            padding: 0;
            border: none;
        }
        a {
            color: #3498db;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #3498db;
            color: white;
        }
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        ul, ol {
            padding-left: 20px;
        }
        li {
            margin: 8px 0;
        }
        .toc-container {
            background-color: #f8f9fa;
            border-left: 4px solid #3498db;
            padding: 15px;
            margin: 20px 0;
        }
        .footer {
            margin-top: 40px;
            text-align: center;
            color: #7f8c8d;
            font-size: 0.9em;
            border-top: 1px solid #eee;
            padding-top: 20px;
        }
        .highlight {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>QuickShop E-commerce Platform</h1>
        <h2>Complete Deployment Guide</h2>
        <p>Comprehensive guide for deploying QuickShop on Oracle Cloud Infrastructure</p>
    </div>
    <h1 id="quickshop-e-commerce-platform-complete-deployment-guide">QuickShop E-commerce Platform - Complete Deployment Guide</h1>

<h2 id="table-of-contents">Table of Contents</h2>

<ul>
<li><a href="#1-introduction">1. Introduction</a></li>
<li><a href="#2-infrastructure-setup">2. Infrastructure Setup</a></li>
<li><a href="#3-database-configuration">3. Database Configuration</a></li>
<li><a href="#4-domain-configuration">4. Domain Configuration</a></li>
<li><a href="#5-backend-deployment">5. Backend Deployment</a></li>
<li><a href="#6-frontend-deployment">6. Frontend Deployment</a></li>
<li><a href="#7-ssl-configuration">7. SSL Configuration</a></li>
<li><a href="#8-auto-deployment-setup">8. Auto-deployment Setup</a></li>
<li><a href="#9-final-integration">9. Final Integration</a></li>
<li><a href="#10-resources">10. Resources</a></li>
</ul>

<hr />

<h2 id="1-introduction-1-introduction">1. Introduction {#1-introduction}</h2>

<p>Welcome to the complete deployment guide for QuickShop, a modern, AI-powered e-commerce platform. This guide will walk you through setting up your application on Oracle Cloud Infrastructure (OCI) using the Always Free Tier, with proper networking, database, and deployment automation.</p>

<h3 id="project-overview">Project Overview</h3>

<p>QuickShop is a comprehensive e-commerce solution featuring:
- Multi-vendor marketplace
- AI-powered recommendations
- Advanced analytics dashboard
- Mobile-responsive design
- Payment gateway integrations
- Customer support system</p>

<h3 id="requirements">Requirements</h3>

<ul>
<li>Oracle Cloud Infrastructure account (Always Free Tier)</li>
<li>Domain name (already registered with Hostinger)</li>
<li>Basic Linux command-line knowledge</li>
<li>Git and GitHub access</li>
</ul>

<hr />

<h2 id="2-infrastructure-setup-2-infrastructure-setup">2. Infrastructure Setup {#2-infrastructure-setup}</h2>

<h3 id="21-virtual-cloud-network-vcn-configuration">2.1 Virtual Cloud Network (VCN) Configuration</h3>

<h4 id="creating-the-vcn">Creating the VCN</h4>

<ol>
<li><p><strong>Log into OCI Console</strong></p>

<ul>
<li>Navigate to <a href="https://cloud.oracle.com">OCI Console</a></li>
<li>Sign in with your account credentials</li>
</ul></li>
<li><p><strong>Navigate to Virtual Cloud Networks</strong></p>

<ul>
<li>In the left navigation pane, under "Networking", click "Virtual Cloud Networks"</li>
</ul></li>
<li><p><strong>Create VCN</strong></p>

<ul>
<li>Click "Create Virtual Cloud Network"</li>
<li>Fill in the following details:
<ul>
<li><strong>Name</strong>: <code>myvnc</code></li>
<li><strong>Compartment</strong>: Select your root compartment or a specific compartment</li>
<li><strong>Create Virtual Cloud Network</strong>: "VCN with Internet Connectivity"</li>
<li><strong>CIDR Block</strong>: <code>10.0.0.0/16</code></li>
</ul></li>
</ul></li>
<li><p><strong>Configure Subnets and Gateways</strong></p>

<ul>
<li>The wizard will automatically create:
<ul>
<li>Route table with internet gateway</li>
<li>Security list with default rules</li>
<li>DHCP options with default DNS</li>
</ul></li>
</ul></li>
</ol>

<h4 id="vcn-details">VCN Details</h4>

<ul>
<li><strong>Name</strong>: myvnc</li>
<li><strong>CIDR Block</strong>: 10.0.0.0/16</li>
</ul>

<h3 id="22-public-subnet-setup">2.2 Public Subnet Setup</h3>

<h4 id="creating-public-subnet">Creating Public Subnet</h4>

<ol>
<li><strong>In your VCN details page</strong>, click on "Subnets"</li>
<li><strong>Click "Create Subnet"</strong></li>
<li><strong>Fill in the following details</strong>:
<ul>
<li><strong>Subnet Type</strong>: Regional</li>
<li><strong>Name</strong>: <code>public-subnet-myvnc</code></li>
<li><strong>CIDR Block</strong>: <code>10.0.0.0/24</code></li>
<li><strong>Route Table</strong>: Default route table (with internet gateway)</li>
<li><strong>Subnet Access</strong>: Public Subnet</li>
<li><strong>DHCP Options</strong>: Default DHCP options</li>
<li><strong>DNS Resolution</strong>: Use VCN DNS hostname</li>
<li><strong>Security Lists</strong>: Create new or use default</li>
</ul></li>
</ol>

<h4 id="public-subnet-details">Public Subnet Details</h4>

<ul>
<li><strong>Name</strong>: public-subnet-myvnc</li>
<li><strong>CIDR Block</strong>: 10.0.0.0/24</li>
<li><strong>Access</strong>: Public (has internet gateway)</li>
<li><strong>Purpose</strong>: Hosts public-facing applications and load balancers</li>
</ul>

<h3 id="23-private-subnet-setup">2.3 Private Subnet Setup</h3>

<h4 id="creating-private-subnet">Creating Private Subnet</h4>

<ol>
<li><strong>In your VCN details page</strong>, click on "Subnets"</li>
<li><strong>Click "Create Subnet"</strong></li>
<li><strong>Fill in the following details</strong>:
<ul>
<li><strong>Subnet Type</strong>: Regional</li>
<li><strong>Name</strong>: <code>private-subnet-myvnc</code></li>
<li><strong>CIDR Block</strong>: <code>10.0.1.0/24</code></li>
<li><strong>Route Table</strong>: Create custom route table with NAT Gateway</li>
<li><strong>Subnet Access</strong>: Private Subnet</li>
<li><strong>DHCP Options</strong>: Default DHCP options</li>
<li><strong>DNS Resolution</strong>: Use VCN DNS hostname</li>
<li><strong>Security Lists</strong>: Create new or use default</li>
</ul></li>
</ol>

<h4 id="private-subnet-details">Private Subnet Details</h4>

<ul>
<li><strong>Name</strong>: private-subnet-myvnc</li>
<li><strong>CIDR Block</strong>: 10.0.1.0/24</li>
<li><strong>Access</strong>: Private (no direct internet access)</li>
<li><strong>Purpose</strong>: Hosts database and internal services</li>
</ul>

<h3 id="24-security-rules-configuration">2.4 Security Rules Configuration</h3>

<h4 id="public-subnet-security-list-rules">Public Subnet Security List Rules</h4>

<p><strong>Ingress Rules (Inbound)</strong>:
1. <strong>For HTTP traffic</strong>:
   - <strong>Source Type</strong>: CIDR
   - <strong>Source CIDR</strong>: <code>0.0.0.0/0</code>
   - <strong>IP Protocol</strong>: TCP
   - <strong>Source Port Range</strong>: All
   - <strong>Destination Port Range</strong>: <code>80</code></p>

<ol start="2">
<li><p><strong>For HTTPS traffic</strong>:</p>

<ul>
<li><strong>Source Type</strong>: CIDR</li>
<li><strong>Source CIDR</strong>: <code>0.0.0.0/0</code></li>
<li><strong>IP Protocol</strong>: TCP</li>
<li><strong>Source Port Range</strong>: All</li>
<li><strong>Destination Port Range</strong>: <code>443</code></li>
</ul></li>
<li><p><strong>For SSH traffic</strong>:</p>

<ul>
<li><strong>Source Type</strong>: CIDR</li>
<li><strong>Source CIDR</strong>: <code>0.0.0.0/0</code> <em>(More restrictive: your IP range)</em></li>
<li><strong>IP Protocol</strong>: TCP</li>
<li><strong>Source Port Range</strong>: All</li>
<li><strong>Destination Port Range</strong>: <code>22</code></li>
</ul></li>
<li><p><strong>For custom application</strong>:</p>

<ul>
<li><strong>Source Type</strong>: CIDR</li>
<li><strong>Source CIDR</strong>: <code>0.0.0.0/0</code></li>
<li><strong>IP Protocol</strong>: TCP</li>
<li><strong>Source Port Range</strong>: All</li>
<li><strong>Destination Port Range</strong>: <code>5000</code></li>
</ul></li>
</ol>

<h4 id="private-subnet-security-list-rules">Private Subnet Security List Rules</h4>

<p><strong>Ingress Rules (Inbound)</strong>:
1. <strong>For MySQL traffic</strong>:
   - <strong>Source Type</strong>: CIDR
   - <strong>Source CIDR</strong>: <code>10.0.0.0/16</code>
   - <strong>IP Protocol</strong>: TCP
   - <strong>Source Port Range</strong>: All
   - <strong>Destination Port Range</strong>: <code>3306</code></p>

<ol start="2">
<li><p><strong>For custom application</strong>:</p>

<ul>
<li><strong>Source Type</strong>: CIDR</li>
<li><strong>Source CIDR</strong>: <code>10.0.0.0/24</code></li>
<li><strong>IP Protocol</strong>: TCP</li>
<li><strong>Source Port Range</strong>: All</li>
<li><strong>Destination Port Range</strong>: <code>5000</code></li>
</ul></li>
<li><p><strong>For Redis traffic</strong>:</p>

<ul>
<li><strong>Source Type</strong>: CIDR</li>
<li><strong>Source CIDR</strong>: <code>10.0.0.0/16</code></li>
<li><strong>IP Protocol</strong>: TCP</li>
<li><strong>Source Port Range</strong>: All</li>
<li><strong>Destination Port Range</strong>: <code>6379</code></li>
</ul></li>
</ol>

<p><strong>Egress Rules (Outbound)</strong>:
1. <strong>For internet access</strong>:
   - <strong>Destination Type</strong>: CIDR
   - <strong>Destination CIDR</strong>: <code>0.0.0.0/0</code>
   - <strong>IP Protocol</strong>: All
   - <strong>Destination Port Range</strong>: All</p>

<h3 id="25-compute-instance-setup">2.5 Compute Instance Setup</h3>

<h4 id="creating-the-instance">Creating the Instance</h4>

<ol>
<li><strong>Navigate to "Compute"</strong> in the OCI console</li>
<li><strong>Click "Instances"</strong></li>
<li><strong>Click "Create Instance"</strong></li>
<li><p><strong>Fill in the following details</strong>:</p>

<ul>
<li><strong>Name</strong>: <code>quickshop</code></li>
<li><strong>Placement</strong>: Choose any availability domain</li>
<li><strong>Image</strong>: Canonical Ubuntu 24.04</li>
<li><strong>Shape</strong>: VM.Standard.E4.Flex (for Always Free Tier)</li>
<li><strong>OCPUs</strong>: 1</li>
<li><strong>Memory</strong>: 1 GB (minimum for Always Free Tier)</li>
<li><strong>Boot Volume</strong>: 50 GB (minimum for Always Free Tier)</li>
</ul></li>
<li><p><strong>Networking Configuration</strong>:</p>

<ul>
<li><strong>VNIC</strong>: Primary VNIC</li>
<li><strong>Subnet</strong>: Select your public subnet (<code>public-subnet-myvnc</code>)</li>
<li><strong>Assign a public IP</strong>: Yes</li>
</ul></li>
<li><p><strong>Add SSH Keys</strong>:</p>

<ul>
<li><strong>Paste your public SSH key</strong> in the provided field</li>
<li>Or upload your public key file</li>
</ul></li>
<li><p><strong>Create the instance</strong> by clicking "Create"</p></li>
</ol>

<h4 id="instance-details">Instance Details</h4>

<ul>
<li><strong>Name</strong>: quickshop</li>
<li><strong>Public IP</strong>: 141.148.196.251</li>
<li><strong>Private IP</strong>: 10.0.0.172</li>
<li><strong>Operating System</strong>: Canonical Ubuntu 24.04</li>
</ul>

<hr />

<h2 id="3-database-configuration-3-database-configuration">3. Database Configuration {#3-database-configuration}</h2>

<h3 id="31-setting-up-oci-mysql-heatwave-always-free-tier">3.1 Setting up OCI MySQL Heatwave (Always Free Tier)</h3>

<h4 id="prerequisites-for-mysql-setup">Prerequisites for MySQL Setup</h4>

<p>Before creating your MySQL database, ensure you have:
- Selected the appropriate compartment in OCI
- Made sure the private subnet (<code>private-subnet-myvnc</code>) is created in the same availability domain</p>

<h4 id="creating-mysql-heatwave-database">Creating MySQL Heatwave Database</h4>

<ol>
<li><p><strong>Navigate to "MySQL"</strong> in the OCI console</p>

<ul>
<li>From the OCI dashboard, search for "MySQL Database Systems" or find it under "Database" services</li>
</ul></li>
<li><p><strong>Click "Create MySQL Database System"</strong></p>

<ul>
<li>On the MySQL Database Systems page, click the "Create MySQL DB System" button</li>
</ul></li>
<li><p><strong>Choose "Free Tier" option</strong></p>

<ul>
<li>In the creation page, select "Free Tier" as the DB System Type</li>
<li>Note: Free tier provides 1 OCPU and 1 GB memory with 50 GB storage</li>
</ul></li>
<li><p><strong>Fill in the required details</strong>:</p>

<p><strong>Database System Information</strong>:</p>

<ul>
<li><strong>Display Name</strong>: <code>my-mysql-db</code></li>
<li><strong>DB System Identifier</strong>: <code>my-mysql-db</code> (must be unique in your region)</li>
<li><strong>Description</strong>: "QuickShop database for production"</li>
<li><strong>Compartment</strong>: Select your compartment (typically root compartment or dedicated compartment)</li>
<li><strong>Availability Domain</strong>: Select any available AD in your region</li>
<li><strong>Fault Domain</strong>: Default (can select any)</li>
</ul>

<p><strong>MySQL Configuration</strong>:</p>

<ul>
<li><strong>Shape</strong>: VM.Standard.E4.Flex (with 1 OCPU and 1 GB memory for free tier)</li>
<li><strong>MySQL Version</strong>: MySQL 8.0.x (latest available in free tier)</li>
<li><strong>Admin Username</strong>: <code>admin</code> (default, you can change if needed)</li>
<li><strong>Admin Password</strong>: Create a strong password that meets requirements:
<ul>
<li>At least 8 characters</li>
<li>Contains uppercase, lowercase, number, and special character</li>
</ul></li>
<li><strong>Confirm Password</strong>: Re-enter your strong password</li>
</ul>

<p><strong>Network Configuration</strong>:</p>

<ul>
<li><strong>Virtual Cloud Network Compartment</strong>: Same compartment as VCN</li>
<li><strong>Virtual Cloud Network</strong>: <code>myvnc</code></li>
<li><strong>Client Subnet Compartment</strong>: Same compartment</li>
<li><strong>Client Subnet</strong>: <code>private-subnet-myvnc</code> (your private subnet)</li>
<li><strong>Is Private?</strong>: Yes (should be in private subnet)</li>
<li><strong>Port for MySQL</strong>: 3306 (default)</li>
</ul></li>
<li><p><strong>Review and Create</strong>:</p>

<ul>
<li>Verify all settings before clicking "Create"</li>
<li>Provisioning takes approximately 10-15 minutes</li>
</ul></li>
<li><p><strong>Wait for provisioning</strong>:</p>

<ul>
<li>The DB system status will change from "Creating" to "Active"</li>
<li>Note the private IP address assigned (will be in the 10.0.1.x range)</li>
</ul></li>
</ol>

<h4 id="database-connection-details">Database Connection Details</h4>

<ul>
<li><strong>DB System Identifier</strong>: my-mysql-db</li>
<li><strong>Private IP</strong>: Will be assigned during creation (e.g., 10.0.1.23)</li>
<li><strong>Username</strong>: admin</li>
<li><strong>Port</strong>: 3306</li>
<li><strong>Connection Type</strong>: Internal (within the same VCN)</li>
</ul>

<h4 id="connecting-to-mysql-from-your-instance">Connecting to MySQL from Your Instance</h4>

<ol>
<li><p><strong>Access your compute instance</strong> via SSH:</p>

<div class="codehilite">
<pre><span></span><code>ssh<span class="w"> </span>-i<span class="w"> </span>your_private_key.pem<span class="w"> </span>ubuntu@141.148.196.251
</code></pre>
</div></li>
<li><p><strong>Install MySQL client</strong> on your instance:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>update
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>mysql-client<span class="w"> </span>-y
</code></pre>
</div></li>
<li><p><strong>Test the connection</strong> to your MySQL database (use the actual private IP assigned to your DB):</p>

<div class="codehilite">
<pre><span></span><code>mysql<span class="w"> </span>-h<span class="w"> </span><span class="m">10</span>.0.1.23<span class="w"> </span>-u<span class="w"> </span>admin<span class="w"> </span>-p
</code></pre>
</div></li>
<li><p><strong>Alternative connection command</strong> with full details:</p>

<div class="codehilite">
<pre><span></span><code>mysql<span class="w"> </span>-h<span class="w"> </span><span class="m">10</span>.0.1.23<span class="w"> </span>-P<span class="w"> </span><span class="m">3306</span><span class="w"> </span>-u<span class="w"> </span>admin<span class="w"> </span>-p
</code></pre>
</div></li>
</ol>

<h4 id="important-mysql-configuration-notes">Important MySQL Configuration Notes</h4>

<ul>
<li>The MySQL instance is in a private subnet and can only be accessed from other resources in the same VCN</li>
<li>The root password cannot be retrieved once created, so store it securely</li>
<li>The free tier has limitations on CPU and memory usage</li>
</ul>

<h3 id="32-database-schema-setup">3.2 Database Schema Setup</h3>

<ol>
<li><p><strong>Clone the QuickShop repository</strong> on your compute instance:</p>

<div class="codehilite">
<pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/echelonxventures/quickshop.git
<span class="nb">cd</span><span class="w"> </span>quickshop
</code></pre>
</div></li>
<li><p><strong>Navigate to the database directory</strong> to check schema files:</p>

<div class="codehilite">
<pre><span></span><code>ls<span class="w"> </span>database/
</code></pre>
</div>

<p>You should see <code>schema.sql</code> and <code>seed_data.sql</code> files</p></li>
<li><p><strong>Create the database</strong> on your MySQL instance:</p>

<div class="codehilite">
<pre><span></span><code>mysql<span class="w"> </span>-h<span class="w"> </span><span class="m">10</span>.0.1.23<span class="w"> </span>-u<span class="w"> </span>admin<span class="w"> </span>-p<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;CREATE DATABASE quickshop CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;&quot;</span>
</code></pre>
</div></li>
<li><p><strong>Import schema</strong> (database structure):</p>

<div class="codehilite">
<pre><span></span><code>mysql<span class="w"> </span>-h<span class="w"> </span><span class="m">10</span>.0.1.23<span class="w"> </span>-u<span class="w"> </span>admin<span class="w"> </span>-p<span class="w"> </span>quickshop<span class="w"> </span>&lt;<span class="w"> </span>database/schema.sql
</code></pre>
</div></li>
<li><p><strong>Import seed data</strong> (sample data):</p>

<div class="codehilite">
<pre><span></span><code>mysql<span class="w"> </span>-h<span class="w"> </span><span class="m">10</span>.0.1.23<span class="w"> </span>-u<span class="w"> </span>admin<span class="w"> </span>-p<span class="w"> </span>quickshop<span class="w"> </span>&lt;<span class="w"> </span>database/seed_data.sql
</code></pre>
</div></li>
<li><p><strong>Verify the database was created</strong>:</p>

<div class="codehilite">
<pre><span></span><code>mysql<span class="w"> </span>-h<span class="w"> </span><span class="m">10</span>.0.1.23<span class="w"> </span>-u<span class="w"> </span>admin<span class="w"> </span>-p<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;SHOW DATABASES LIKE &#39;quickshop&#39;;&quot;</span>
</code></pre>
</div></li>
<li><p><strong>Check tables were created</strong>:</p>

<div class="codehilite">
<pre><span></span><code>mysql<span class="w"> </span>-h<span class="w"> </span><span class="m">10</span>.0.1.23<span class="w"> </span>-u<span class="w"> </span>admin<span class="w"> </span>-p<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;USE quickshop; SHOW TABLES;&quot;</span>
</code></pre>
</div></li>
</ol>

<h3 id="33-database-connection-testing-from-application">3.3 Database Connection Testing from Application</h3>

<ol>
<li><p><strong>Test connection from backend code</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/quickshop/backend
</code></pre>
</div></li>
<li><p><strong>Create a simple connection test</strong>:</p>

<div class="codehilite">
<pre><span></span><code>nano<span class="w"> </span>test-db-connection.js
</code></pre>
</div>

<p><strong>Add the following test code</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">mysql</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;mysql2/promise&#39;</span><span class="p">);</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">connectionConfig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">host</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;10.0.1.23&#39;</span><span class="p">,</span><span class="w">  </span><span class="c1">// Replace with your actual private IP</span>
<span class="w">  </span><span class="nx">user</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;admin&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">password</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;your_admin_password&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">database</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;quickshop&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">port</span><span class="o">:</span><span class="w"> </span><span class="mf">3306</span><span class="p">,</span>
<span class="w">  </span><span class="nx">connectTimeout</span><span class="o">:</span><span class="w"> </span><span class="mf">60000</span><span class="p">,</span><span class="w"> </span><span class="c1">// 60 seconds</span>
<span class="w">  </span><span class="nx">acquireTimeout</span><span class="o">:</span><span class="w"> </span><span class="mf">60000</span><span class="p">,</span>
<span class="w">  </span><span class="nx">timeout</span><span class="o">:</span><span class="w"> </span><span class="mf">60000</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">testConnection</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Attempting to connect to MySQL database...&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">mysql</span><span class="p">.</span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">connectionConfig</span><span class="p">);</span>

<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Connected to MySQL database successfully!&#39;</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Test query</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">rows</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">connection</span><span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="s1">&#39;SELECT 1 + 1 AS solution&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Test query result:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">rows</span><span class="p">[</span><span class="mf">0</span><span class="p">]);</span>

<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="nx">connection</span><span class="p">.</span><span class="nx">end</span><span class="p">();</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Connection closed.&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Connection failed:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="nx">testConnection</span><span class="p">();</span>
</code></pre>
</div></li>
<li><p><strong>Install required package</strong> for the test:</p>

<div class="codehilite">
<pre><span></span><code>npm<span class="w"> </span>install<span class="w"> </span>mysql2
</code></pre>
</div></li>
<li><p><strong>Run the test</strong>:</p>

<div class="codehilite">
<pre><span></span><code>node<span class="w"> </span>test-db-connection.js
</code></pre>
</div></li>
<li><p><strong>Clean up</strong> after testing:</p>

<div class="codehilite">
<pre><span></span><code>rm<span class="w"> </span>test-db-connection.js
</code></pre>
</div></li>
</ol>

<hr />

<h2 id="4-domain-configuration-4-domain-configuration">4. Domain Configuration {#4-domain-configuration}</h2>

<h3 id="41-configuring-domain-with-hostinger">4.1 Configuring Domain with Hostinger</h3>

<h4 id="prerequisites">Prerequisites</h4>

<ul>
<li>Access to your Hostinger account</li>
<li>Domain already registered: <code>quickshop.echelonxventures.org</code></li>
<li>Public IP of your OCI instance: <code>141.148.196.251</code></li>
</ul>

<h4 id="step-by-step-domain-configuration">Step-by-Step Domain Configuration</h4>

<ol>
<li><p><strong>Log in to your Hostinger account</strong></p>

<ul>
<li>Navigate to <a href="https://www.hostinger.com/cpanel">Hostinger Customer Panel</a></li>
<li>Enter your login credentials (email and password)</li>
<li>Click "Log In"</li>
</ul></li>
<li><p><strong>Access Domain Management</strong></p>

<ul>
<li>In the dashboard, find and click on "Domains" in the main navigation</li>
<li>Or look for "Domain Management" in the side panel</li>
<li>You should see a list of your domains</li>
</ul></li>
<li><p><strong>Select your domain</strong></p>

<ul>
<li>Find <code>quickshop.echelonxventures.org</code> in the domain list</li>
<li>Click on the domain name or the "Manage" button next to it</li>
<li>This will take you to the domain management page</li>
</ul></li>
</ol>

<h4 id="dns-configuration-setup">DNS Configuration Setup</h4>

<p><strong>A Record Configuration</strong>:
1. <strong>Navigate to DNS Management</strong>
   - Once in the domain management page, look for "DNS Management", "DNS Records", or "Zone Editor"
   - Click on the appropriate option to access DNS records</p>

<ol start="2">
<li><p><strong>Locate and modify A record for root domain</strong>:</p>

<ul>
<li>Find the A record with <strong>Name</strong> or <strong>Host</strong> as <code>@</code> or <code>(none)</code> or <code>quickshop.echelonxventures.org.</code></li>
<li><strong>Current IP</strong>: May be a placeholder or existing IP</li>
<li><strong>Change To</strong>: <code>141.148.196.251</code></li>
<li><strong>TTL</strong>: Keep as default (usually 14400 or 1 hour) or set to 300 for faster propagation if needed</li>
<li>Click "Save", "Update", or the checkmark button</li>
</ul></li>
<li><p><strong>Locate and modify A record for www subdomain</strong>:</p>

<ul>
<li>Find the A record with <strong>Name</strong> or <strong>Host</strong> as <code>www</code> or <code>www.quickshop.echelonxventures.org.</code></li>
<li><strong>Current IP</strong>: May be a placeholder or existing IP</li>
<li><strong>Change To</strong>: <code>141.148.196.251</code></li>
<li><strong>TTL</strong>: Keep as default or set to 300</li>
<li>Click "Save", "Update", or the checkmark button</li>
</ul></li>
<li><p><strong>Add additional A records if needed</strong>:</p>

<ul>
<li>If you plan to have other subdomains like <code>api.quickshop.echelonxventures.org</code> or <code>admin.quickshop.echelonxventures.org</code></li>
<li>Create additional A records with:
<ul>
<li><strong>Name/Host</strong>: <code>api</code> (for api.quickshop.echelonxventures.org)</li>
<li><strong>Type</strong>: A</li>
<li><strong>Value/Points to</strong>: <code>141.148.196.251</code></li>
<li><strong>TTL</strong>: Default</li>
</ul></li>
</ul></li>
</ol>

<h4 id="additional-dns-records-optional-but-recommended">Additional DNS Records (Optional but Recommended)</h4>

<p><strong>MX Records for Email</strong> (if you plan to use email hosting):
- Keep existing MX records or configure according to your email provider's requirements</p>

<p><strong>TXT Records for Domain Verification</strong> (if needed later):
- You may need to add TXT records for Google Workspace, email verification, or other services</p>

<h4 id="dns-propagation-and-verification">DNS Propagation and Verification</h4>

<p><strong>Check DNS Records</strong>:
1. <strong>Use online DNS checker tools</strong>:
   - Visit <a href="https://dnschecker.org/">DNS Checker</a> or <a href="https://www.whatsmydns.net/">What's My DNS</a>
   - Enter <code>quickshop.echelonxventures.org</code> and check A record status
   - Select multiple locations to verify global propagation</p>

<ol start="2">
<li><strong>Command line verification</strong> (from your local machine):
<div class="codehilite">
<pre><span></span><code><span class="c1"># Check A record</span>
nslookup<span class="w"> </span>quickshop.echelonxventures.org
<span class="c1"># Or</span>
dig<span class="w"> </span>quickshop.echelonxventures.org<span class="w"> </span>A
<span class="c1"># Or</span>
ping<span class="w"> </span>quickshop.echelonxventures.org
</code></pre>
</div></li>
</ol>

<p><strong>Propagation Timeline</strong>:
- <strong>Initial propagation</strong>: 1-4 hours for most regions
- <strong>Complete global propagation</strong>: Up to 24-48 hours in rare cases
- <strong>TTL factor</strong>: Lower TTL values result in faster propagation</p>

<h4 id="testing-domain-access">Testing Domain Access</h4>

<ol>
<li><p><strong>Test HTTP access</strong> (after DNS propagation):</p>

<ul>
<li>Open a web browser</li>
<li>Navigate to <code>http://quickshop.echelonxventures.org</code></li>
<li>You should see your application or a placeholder page</li>
</ul></li>
<li><p><strong>Test with curl</strong> from command line:</p>

<div class="codehilite">
<pre><span></span><code>curl<span class="w"> </span>-I<span class="w"> </span>http://quickshop.echelonxventures.org
</code></pre>
</div>

<p>You should see HTTP headers indicating the server is responding</p></li>
<li><p><strong>Check IP resolution</strong>:</p>

<div class="codehilite">
<pre><span></span><code>ping<span class="w"> </span>quickshop.echelonxventures.org
</code></pre>
</div>

<p>Should return <code>141.148.196.251</code></p></li>
</ol>

<h4 id="common-issues-and-troubleshooting">Common Issues and Troubleshooting</h4>

<p><strong>DNS Not Resolving</strong>:
- Ensure you've saved the DNS changes in Hostinger
- Wait for DNS propagation (can take up to 48 hours)
- Clear your browser cache and DNS cache on your machine:
  <div class="codehilite">
  <pre><span></span><code><span class="c1"># On Windows</span>
  ipconfig<span class="w"> </span>/flushdns</p>

<p><span class="c1"># On Mac/Linux</span>
  sudo<span class="w"> </span>dscacheutil<span class="w"> </span>-flushcache<span class="w">  </span><span class="c1"># Mac</span>
  sudo<span class="w"> </span>systemd-resolve<span class="w"> </span>--flush-caches<span class="w">  </span><span class="c1"># Linux with systemd</span>
  sudo<span class="w"> </span>/etc/init.d/dns-clean<span class="w"> </span>start<span class="w">  </span><span class="c1"># Other Linux</span>
  </code></pre>
  </div></p>

<p><strong>Wrong IP Address</strong>:
- Double-check that you entered the correct public IP: <code>141.148.196.251</code>
- Verify the A records in Hostinger panel match this IP</p>

<p><strong>Mixed Content Issues</strong>:
- Initially test with HTTP until SSL is configured
- After SSL setup, all traffic should redirect to HTTPS</p>

<hr />

<h2 id="5-backend-deployment-5-backend-deployment">5. Backend Deployment {#5-backend-deployment}</h2>

<h3 id="51-server-preparation">5.1 Server Preparation</h3>

<ol>
<li><p><strong>SSH into your OCI instance</strong>:</p>

<div class="codehilite">
<pre><span></span><code>ssh<span class="w"> </span>-i<span class="w"> </span>your_private_key.pem<span class="w"> </span>ubuntu@141.148.196.251
</code></pre>
</div>

<p><strong>Note</strong>: Replace <code>your_private_key.pem</code> with the path to your actual SSH private key file</p></li>
<li><p><strong>Update the system</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sudo<span class="w"> </span>apt<span class="w"> </span>upgrade<span class="w"> </span>-y
</code></pre>
</div></li>
<li><p><strong>Install required packages for build tools</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>curl<span class="w"> </span>git<span class="w"> </span>build-essential<span class="w"> </span>libtool-bin<span class="w"> </span>autoconf<span class="w"> </span>automake<span class="w"> </span>pkg-config<span class="w"> </span>libssl-dev<span class="w"> </span>-y
</code></pre>
</div></li>
<li><p><strong>Verify available disk space</strong>:</p>

<div class="codehilite">
<pre><span></span><code>df<span class="w"> </span>-h
</code></pre>
</div>

<p>Ensure you have at least 2GB of free space for the application and dependencies</p></li>
</ol>

<h3 id="52-nodejs-and-pm2-installation">5.2 Node.js and PM2 Installation</h3>

<ol>
<li><p><strong>Install Node.js using NodeSource repository</strong> (LTS version recommended):</p>

<div class="codehilite">
<pre><span></span><code><span class="c1"># Check current LTS version at https://nodejs.org/</span>
<span class="c1"># As of late 2024, Node.js 20.x LTS is recommended</span>
curl<span class="w"> </span>-fsSL<span class="w"> </span>https://deb.nodesource.com/setup_lts.x<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>-E<span class="w"> </span>bash<span class="w"> </span>-
sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>nodejs
</code></pre>
</div></li>
<li><p><strong>Verify Node.js installation</strong>:</p>

<div class="codehilite">
<pre><span></span><code>node<span class="w"> </span>--version
npm<span class="w"> </span>--version
</code></pre>
</div>

<p>You should see Node.js version 20.x.x and npm version 10.x.x</p></li>
<li><p><strong>Update npm to latest version</strong> (recommended):</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>npm<span class="w"> </span>install<span class="w"> </span>-g<span class="w"> </span>npm@latest
</code></pre>
</div></li>
<li><p><strong>Install PM2 globally</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>npm<span class="w"> </span>install<span class="w"> </span>-g<span class="w"> </span>pm2
</code></pre>
</div></li>
<li><p><strong>Start PM2 on system boot</strong>:</p>

<div class="codehilite">
<pre><span></span><code>pm2<span class="w"> </span>startup
sudo<span class="w"> </span>env<span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:/usr/bin<span class="w"> </span>/usr/lib/node_modules/pm2/bin/pm2<span class="w"> </span>startup<span class="w"> </span>systemd<span class="w"> </span>-u<span class="w"> </span>ubuntu<span class="w"> </span>--hp<span class="w"> </span>/home/ubuntu
pm2<span class="w"> </span>save
</code></pre>
</div></li>
<li><p><strong>Verify PM2 installation</strong>:</p>

<div class="codehilite">
<pre><span></span><code>pm2<span class="w"> </span>--version
</code></pre>
</div></li>
</ol>

<h3 id="53-backend-application-setup">5.3 Backend Application Setup</h3>

<ol>
<li><p><strong>Clone the repository</strong>:</p>

<div class="codehilite">
<pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/echelonxventures/quickshop.git
<span class="nb">cd</span><span class="w"> </span>quickshop
</code></pre>
</div></li>
<li><p><strong>Switch to the correct branch</strong> (if not main):</p>

<div class="codehilite">
<pre><span></span><code><span class="c1"># Check available branches</span>
git<span class="w"> </span>branch<span class="w"> </span>-a

<span class="c1"># Switch to main or production branch if different</span>
git<span class="w"> </span>checkout<span class="w"> </span>main<span class="w">  </span><span class="c1"># or git checkout production</span>
</code></pre>
</div></li>
<li><p><strong>Navigate to backend directory</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="nb">cd</span><span class="w"> </span>backend
</code></pre>
</div></li>
<li><p><strong>Install backend dependencies</strong>:</p>

<div class="codehilite">
<pre><span></span><code>npm<span class="w"> </span>install
</code></pre>
</div>

<p><strong>Note</strong>: This may take several minutes depending on your internet connection</p></li>
<li><p><strong>Check for existing .env file</strong>:</p>

<div class="codehilite">
<pre><span></span><code>ls<span class="w"> </span>-la<span class="w"> </span>.env*
</code></pre>
</div>

<p>If .env doesn't exist, copy from example:</p>

<div class="codehilite">
<pre><span></span><code>cp<span class="w"> </span>.env.example<span class="w"> </span>.env
</code></pre>
</div></li>
<li><p><strong>Configure environment variables</strong>:</p>

<div class="codehilite">
<pre><span></span><code>nano<span class="w"> </span>.env
</code></pre>
</div>

<p><strong>Key settings for production</strong> (replace placeholder values with actual values):</p>

<pre><code># Application Configuration
NODE_ENV=production
PORT=5000
HOST=0.0.0.0
APP_NAME=QuickShop
APP_VERSION=1.0.0
APP_URL=https://quickshop.echelonxventures.org

# Database Configuration
DB_HOST=10.0.1.23  # Private IP of your MySQL instance
DB_USER=admin
DB_PASSWORD=your_actual_mysql_password  # Replace with your actual password
DB_NAME=quickshop
DB_PORT=3306
DB_SSL_MODE=DISABLED  # For free tier MySQL, SSL may not be available

# Authentication &amp; Security
JWT_SECRET=replace_with_very_long_secret_string_at_least_32_characters_long_for_security
JWT_EXPIRE=7d
BCRYPT_ROUNDS=12

# Redis Configuration (if using Redis on the same instance)
REDIS_URL=redis://localhost:6379
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=  # Leave empty if no password

# Email Configuration (for production - configure with your provider)
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_USER=your_email@gmail.com
EMAIL_PASS=your_app_password  # Use app password for Gmail
FROM_EMAIL=noreply@quickshop.echelonxventures.org
FROM_NAME=QuickShop

# Payment Gateway Configuration
STRIPE_SECRET_KEY=sk_test_your_stripe_secret_key
STRIPE_PUBLISHABLE_KEY=pk_test_your_stripe_publishable_key
PAYPAL_CLIENT_ID=your_paypal_client_id
PAYPAL_CLIENT_SECRET=your_paypal_client_secret
RAZORPAY_KEY_ID=your_razorpay_key_id
RAZORPAY_KEY_SECRET=your_razorpay_key_secret

# Cloud Storage Configuration
CLOUDINARY_CLOUD_NAME=your_cloudinary_cloud_name
CLOUDINARY_API_KEY=your_cloudinary_api_key
CLOUDINARY_API_SECRET=your_cloudinary_api_secret

# AI/ML Configuration
OPENAI_API_KEY=your_openai_api_key

# Security Configuration
CORS_ORIGIN=https://quickshop.echelonxventures.org
TRUST_PROXY=1

# Logging Configuration
LOG_LEVEL=info
LOG_FILE_SIZE=10m
LOG_FILE_COUNT=5

# Rate Limiting
RATE_LIMIT_WINDOW_MS=900000  # 15 minutes
RATE_LIMIT_MAX=100

# File Upload Configuration
MAX_FILE_SIZE=10485760  # 10MB
UPLOAD_DIR=./uploads
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/gif,application/pdf
</code></pre></li>
<li><p><strong>Create required directories</strong>:</p>

<div class="codehilite">
<pre><span></span><code>mkdir<span class="w"> </span>-p<span class="w"> </span>uploads<span class="w"> </span>logs
sudo<span class="w"> </span>chown<span class="w"> </span>-R<span class="w"> </span>ubuntu:ubuntu<span class="w"> </span>uploads<span class="w"> </span>logs
sudo<span class="w"> </span>chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">755</span><span class="w"> </span>uploads<span class="w"> </span>logs
</code></pre>
</div></li>
<li><p><strong>Test the application locally</strong> (before using PM2):</p>

<div class="codehilite">
<pre><span></span><code>node<span class="w"> </span>server.js
</code></pre>
</div>

<p><strong>Note</strong>: Press <code>Ctrl+C</code> to stop the application after testing</p></li>
<li><p><strong>Set up PM2 configuration file</strong> (in the main quickshop directory):</p>

<div class="codehilite">
<pre><span></span><code><span class="nb">cd</span><span class="w"> </span>..
nano<span class="w"> </span>ecosystem.config.js
</code></pre>
</div>

<p><strong>Content for ecosystem.config.js</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">apps</span><span class="o">:</span><span class="w"> </span><span class="p">[{</span>
<span class="w">    </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;quickshop-backend&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">script</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;./backend/server.js&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">instances</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="c1">// For free tier, limit to 1 instance to save memory</span>
<span class="w">    </span><span class="nx">exec_mode</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;fork&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Use fork mode instead of cluster for simpler memory usage</span>
<span class="w">    </span><span class="nx">env</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">NODE_ENV</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;production&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">PORT</span><span class="o">:</span><span class="w"> </span><span class="mf">5000</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nx">error_file</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;./backend/logs/err.log&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">out_file</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;./backend/logs/out.log&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">log_file</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;./backend/logs/combined.log&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">time</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nx">max_memory_restart</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;512M&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Restart if memory usage exceeds 512MB</span>
<span class="w">    </span><span class="nx">node_args</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;--max-old-space-size=512&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Limit node memory usage for free tier</span>
<span class="w">    </span><span class="nx">watch</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"> </span><span class="c1">// Don&#39;t watch for changes in production</span>
<span class="w">    </span><span class="nx">ignore_watch</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;node_modules&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;logs&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.git&#39;</span><span class="p">],</span>
<span class="w">    </span><span class="nx">exp_backoff_restart_delay</span><span class="o">:</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span><span class="w"> </span><span class="c1">// Restart quickly if crashes</span>
<span class="w">    </span><span class="nx">max_restarts</span><span class="o">:</span><span class="w"> </span><span class="mf">30</span><span class="p">,</span><span class="w"> </span><span class="c1">// Max restarts per minute</span>
<span class="w">    </span><span class="nx">min_uptime</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;10s&#39;</span><span class="w"> </span><span class="c1">// App needs to be up for at least 10s to be considered started</span>
<span class="w">  </span><span class="p">}]</span>
<span class="p">};</span>
</code></pre>
</div></li>
<li><p><strong>Create logs directory in backend folder</strong>:</p>

<div class="codehilite">
<pre><span></span><code>mkdir<span class="w"> </span>-p<span class="w"> </span>backend/logs
</code></pre>
</div></li>
<li><p><strong>Start the backend application with PM2</strong>:</p>

<div class="codehilite">
<pre><span></span><code>pm2<span class="w"> </span>start<span class="w"> </span>ecosystem.config.js
</code></pre>
</div></li>
<li><p><strong>Verify the application is running</strong>:</p>

<div class="codehilite">
<pre><span></span><code>pm2<span class="w"> </span>status
pm2<span class="w"> </span>logs<span class="w"> </span>quickshop-backend<span class="w"> </span>--lines<span class="w"> </span><span class="m">20</span>
</code></pre>
</div></li>
<li><p><strong>Test the backend</strong>:</p>

<div class="codehilite">
<pre><span></span><code>curl<span class="w"> </span>http://localhost:5000/health
<span class="c1"># Should return: {&quot;status&quot;:&quot;OK&quot;,&quot;timestamp&quot;:&quot;2024-12-05T10:30:00.000Z&quot;}</span>
</code></pre>
</div></li>
</ol>

<h3 id="54-backend-production-configuration">5.4 Backend Production Configuration</h3>

<ol>
<li><p><strong>Monitor memory usage</strong>:</p>

<div class="codehilite">
<pre><span></span><code>pm2<span class="w"> </span>monit
</code></pre>
</div>

<p>Press <code>Ctrl+C</code> to exit monitoring</p></li>
<li><p><strong>Set up log rotation</strong> (to prevent logs from consuming all disk space):</p>

<div class="codehilite">
<pre><span></span><code>pm2<span class="w"> </span>install<span class="w"> </span>pm2-logrotate
pm2<span class="w"> </span><span class="nb">set</span><span class="w"> </span>pm2-logrotate:max_size<span class="w"> </span>10M
pm2<span class="w"> </span><span class="nb">set</span><span class="w"> </span>pm2-logrotate:retain<span class="w"> </span><span class="m">5</span>
pm2<span class="w"> </span><span class="nb">set</span><span class="w"> </span>pm2-logrotate:compress<span class="w"> </span><span class="nb">true</span>
</code></pre>
</div></li>
<li><p><strong>Configure firewall to allow backend port</strong> (if UFW is enabled):</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span><span class="m">5000</span>
sudo<span class="w"> </span>ufw<span class="w"> </span>reload
</code></pre>
</div></li>
<li><p><strong>Test external access</strong> (from your local machine):</p>

<div class="codehilite">
<pre><span></span><code>curl<span class="w"> </span>http://141.148.196.251:5000/health
</code></pre>
</div></li>
<li><p><strong>Create a health check script</strong> for monitoring:</p>

<div class="codehilite">
<pre><span></span><code>nano<span class="w"> </span>~/backend-health-check.sh
</code></pre>
</div>

<p><strong>Content for health check script</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="ch">#!/bin/bash</span>
<span class="c1"># Backend health check script</span>

<span class="c1"># Check if PM2 process is running</span>
<span class="k">if</span><span class="w"> </span>pm2<span class="w"> </span>status<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-q<span class="w"> </span><span class="s2">&quot;quickshop-backend.*online&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>date<span class="k">)</span><span class="s2">: Backend is running&quot;</span>

<span class="w">    </span><span class="c1"># Test API endpoint</span>
<span class="w">    </span><span class="nv">response</span><span class="o">=</span><span class="k">$(</span>curl<span class="w"> </span>-s<span class="w"> </span>-o<span class="w"> </span>/dev/null<span class="w"> </span>-w<span class="w"> </span><span class="s2">&quot;%{http_code}&quot;</span><span class="w"> </span>http://localhost:5000/health<span class="k">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$response</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;200&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>date<span class="k">)</span><span class="s2">: Backend API is responding correctly (Status: </span><span class="nv">$response</span><span class="s2">)&quot;</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>date<span class="k">)</span><span class="s2">: Backend API is not responding correctly (Status: </span><span class="nv">$response</span><span class="s2">)&quot;</span>
<span class="w">        </span><span class="c1"># Optionally restart the service</span>
<span class="w">        </span><span class="c1"># pm2 restart quickshop-backend</span>
<span class="w">    </span><span class="k">fi</span>
<span class="k">else</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>date<span class="k">)</span><span class="s2">: Backend is not running, attempting restart&quot;</span>
<span class="w">    </span>pm2<span class="w"> </span>start<span class="w"> </span>quickshop-backend
<span class="k">fi</span>
</code></pre>
</div>

<p>Make the script executable:</p>

<div class="codehilite">
<pre><span></span><code>chmod<span class="w"> </span>+x<span class="w"> </span>~/backend-health-check.sh
</code></pre>
</div></li>
<li><p><strong>Set up a cron job</strong> for periodic health checks (optional):</p>

<div class="codehilite">
<pre><span></span><code>crontab<span class="w"> </span>-e
</code></pre>
</div>

<p>Add this line to run health check every 5 minutes:</p>

<pre><code>*/5 * * * * /home/ubuntu/backend-health-check.sh &gt;&gt; /home/ubuntu/backend-health.log 2&gt;&amp;1
</code></pre></li>
</ol>

<h3 id="55-database-connection-verification">5.5 Database Connection Verification</h3>

<ol>
<li><p><strong>Test database connection from backend</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/quickshop/backend
<span class="c1"># Install a simple test script</span>
npm<span class="w"> </span>install<span class="w"> </span>mysql2
</code></pre>
</div></li>
<li><p><strong>Create a database connection test</strong>:</p>

<div class="codehilite">
<pre><span></span><code>nano<span class="w"> </span>test-connection.js
</code></pre>
</div>

<p><strong>Content for test-connection.js</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">mysql</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;mysql2/promise&#39;</span><span class="p">);</span>
<span class="nx">require</span><span class="p">(</span><span class="s1">&#39;dotenv&#39;</span><span class="p">).</span><span class="nx">config</span><span class="p">();</span>

<span class="c1">// Use the same connection parameters as your .env file</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">dbConfig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">host</span><span class="o">:</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB_HOST</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;10.0.1.23&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">user</span><span class="o">:</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB_USER</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;admin&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">password</span><span class="o">:</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB_PASSWORD</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;your_password&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">database</span><span class="o">:</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB_NAME</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;quickshop&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">port</span><span class="o">:</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB_PORT</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">3306</span><span class="p">,</span>
<span class="w">  </span><span class="nx">connectTimeout</span><span class="o">:</span><span class="w"> </span><span class="mf">60000</span><span class="p">,</span>
<span class="w">  </span><span class="nx">acquireTimeout</span><span class="o">:</span><span class="w"> </span><span class="mf">60000</span><span class="p">,</span>
<span class="w">  </span><span class="nx">timeout</span><span class="o">:</span><span class="w"> </span><span class="mf">60000</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">testConnection</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Testing database connection...&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">mysql</span><span class="p">.</span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">dbConfig</span><span class="p">);</span>

<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39; Successfully connected to database&#39;</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Test with a simple query</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">rows</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">connection</span><span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="s1">&#39;SELECT NOW() as currentTime&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39; Database query executed successfully:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">rows</span><span class="p">[</span><span class="mf">0</span><span class="p">]);</span>

<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="nx">connection</span><span class="p">.</span><span class="nx">end</span><span class="p">();</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39; Connection closed successfully&#39;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39; Database connection failed:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="w">    </span><span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="nx">testConnection</span><span class="p">();</span>
</code></pre>
</div></li>
<li><p><strong>Run the database test</strong>:</p>

<div class="codehilite">
<pre><span></span><code>node<span class="w"> </span>test-connection.js
</code></pre>
</div></li>
<li><p><strong>Clean up</strong>:</p>

<div class="codehilite">
<pre><span></span><code>rm<span class="w"> </span>test-connection.js
</code></pre>
</div></li>
</ol>

<hr />

<h2 id="6-frontend-deployment-6-frontend-deployment">6. Frontend Deployment {#6-frontend-deployment}</h2>

<h3 id="61-frontend-build-tools-installation">6.1 Frontend Build Tools Installation</h3>

<ol>
<li><p><strong>Navigate to the quickshop directory</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/quickshop
</code></pre>
</div></li>
<li><p><strong>Install Node.js packages for frontend</strong> (if not already done):</p>

<div class="codehilite">
<pre><span></span><code><span class="nb">cd</span><span class="w"> </span>frontend
npm<span class="w"> </span>install
</code></pre>
</div>

<p><strong>Note</strong>: You may need to increase memory limits for build process on the free tier:</p>

<div class="codehilite">
<pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">NODE_OPTIONS</span><span class="o">=</span><span class="s2">&quot;--max_old_space_size=4096&quot;</span>
npm<span class="w"> </span>install
</code></pre>
</div></li>
<li><p><strong>Check for existing build files</strong>:</p>

<div class="codehilite">
<pre><span></span><code>ls<span class="w"> </span>-la
<span class="c1"># Look for package.json, src/ directory, and public/ directory</span>
</code></pre>
</div></li>
<li><p><strong>Configure frontend environment variables</strong>:</p>

<div class="codehilite">
<pre><span></span><code>cp<span class="w"> </span>.env.example<span class="w"> </span>.env
nano<span class="w"> </span>.env
</code></pre>
</div>

<p><strong>Frontend environment variables</strong>:</p>

<pre><code># Frontend Application Settings
REACT_APP_API_URL=https://quickshop.echelonxventures.org/api
REACT_APP_NAME=QuickShop
REACT_APP_VERSION=1.0.0
REACT_APP_ENV=production

# Payment Gateway Configuration
REACT_APP_STRIPE_PUBLISHABLE_KEY=pk_test_your_stripe_publishable_key
REACT_APP_PAYPAL_CLIENT_ID=your_paypal_client_id

# Analytics Configuration
REACT_APP_GA_MEASUREMENT_ID=GA_MEASUREMENT_ID
REACT_APP_HOTJAR_ID=HOTJAR_ID

# Feature Flags
REACT_APP_ENABLE_ANALYTICS=true
REACT_APP_ENABLE_CHATBOT=true
REACT_APP_ENABLE_REVIEWS=true
</code></pre></li>
<li><p><strong>Install build dependencies</strong> (if needed):</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>update
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>build-essential<span class="w"> </span>-y
</code></pre>
</div></li>
</ol>

<h3 id="62-frontend-build-process">6.2 Frontend Build Process</h3>

<ol>
<li><p><strong>Build the production version</strong> with increased memory:</p>

<div class="codehilite">
<pre><span></span><code><span class="c1"># Set memory limit for build process</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">NODE_OPTIONS</span><span class="o">=</span><span class="s2">&quot;--max_old_space_size=4096&quot;</span>

<span class="c1"># Build the application</span>
npm<span class="w"> </span>run<span class="w"> </span>build
</code></pre>
</div>

<p><strong>Note</strong>: This may take several minutes on the free tier instance. If the build fails due to memory issues, you may need to temporarily add swap space:</p>

<div class="codehilite">
<pre><span></span><code><span class="c1"># Add 1GB of swap space (temporary, will be removed after reboot)</span>
sudo<span class="w"> </span>dd<span class="w"> </span><span class="k">if</span><span class="o">=</span>/dev/zero<span class="w"> </span><span class="nv">of</span><span class="o">=</span>/swapfile<span class="w"> </span><span class="nv">bs</span><span class="o">=</span><span class="m">1024</span><span class="w"> </span><span class="nv">count</span><span class="o">=</span><span class="m">1048576</span>
sudo<span class="w"> </span>chmod<span class="w"> </span><span class="m">600</span><span class="w"> </span>/swapfile
sudo<span class="w"> </span>mkswap<span class="w"> </span>/swapfile
sudo<span class="w"> </span>swapon<span class="w"> </span>/swapfile
</code></pre>
</div></li>
<li><p><strong>Verify build was successful</strong>:</p>

<div class="codehilite">
<pre><span></span><code>ls<span class="w"> </span>-la<span class="w"> </span>build/
<span class="c1"># Should show built files: index.html, static/, etc.</span>
</code></pre>
</div></li>
<li><p><strong>Test the build locally</strong> (optional, using a simple server):</p>

<div class="codehilite">
<pre><span></span><code><span class="c1"># Install a simple static server</span>
sudo<span class="w"> </span>npm<span class="w"> </span>install<span class="w"> </span>-g<span class="w"> </span>serve

<span class="c1"># Serve the build (in a separate terminal, test and close)</span>
<span class="c1"># serve -s build -l 4000</span>
</code></pre>
</div></li>
</ol>

<h3 id="63-build-additional-applications">6.3 Build Additional Applications</h3>

<p>Since QuickShop has multiple portals, you need to build each one:</p>

<ol>
<li><p><strong>Build Admin Portal</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/quickshop/admin_portal
npm<span class="w"> </span>install
cp<span class="w"> </span>.env.example<span class="w"> </span>.env
<span class="c1"># Configure admin portal environment variables</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">NODE_OPTIONS</span><span class="o">=</span><span class="s2">&quot;--max_old_space_size=4096&quot;</span>
npm<span class="w"> </span>run<span class="w"> </span>build
</code></pre>
</div></li>
<li><p><strong>Build Support Portal</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/quickshop/support_portal
npm<span class="w"> </span>install
cp<span class="w"> </span>.env.example<span class="w"> </span>.env
<span class="nb">export</span><span class="w"> </span><span class="nv">NODE_OPTIONS</span><span class="o">=</span><span class="s2">&quot;--max_old_space_size=4096&quot;</span>
npm<span class="w"> </span>run<span class="w"> </span>build
</code></pre>
</div></li>
<li><p><strong>Build Analytics Portal</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/quickshop/analytics_portal
npm<span class="w"> </span>install
cp<span class="w"> </span>.env.example<span class="w"> </span>.env
<span class="nb">export</span><span class="w"> </span><span class="nv">NODE_OPTIONS</span><span class="o">=</span><span class="s2">&quot;--max_old_space_size=4096&quot;</span>
npm<span class="w"> </span>run<span class="w"> </span>build
</code></pre>
</div></li>
<li><p><strong>Build Seller Portal</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/quickshop/seller_portal
npm<span class="w"> </span>install
cp<span class="w"> </span>.env.example<span class="w"> </span>.env
<span class="nb">export</span><span class="w"> </span><span class="nv">NODE_OPTIONS</span><span class="o">=</span><span class="s2">&quot;--max_old_space_size=4096&quot;</span>
npm<span class="w"> </span>run<span class="w"> </span>build
</code></pre>
</div></li>
</ol>

<h3 id="64-nginx-installation-and-configuration">6.4 NGINX Installation and Configuration</h3>

<ol>
<li><p><strong>Install NGINX</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>update
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>nginx<span class="w"> </span>-y
</code></pre>
</div></li>
<li><p><strong>Check NGINX status</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>status<span class="w"> </span>nginx
</code></pre>
</div></li>
<li><p><strong>Start and enable NGINX</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>nginx
sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>nginx
</code></pre>
</div></li>
<li><p><strong>Check if NGINX is running</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>netstat<span class="w"> </span>-tlnp<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>:80
</code></pre>
</div>

<p>You should see NGINX listening on port 80.</p></li>
<li><p><strong>Configure firewall for HTTP/HTTPS</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span><span class="s1">&#39;Nginx Full&#39;</span>
sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span><span class="m">80</span>
sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span><span class="m">443</span>
sudo<span class="w"> </span>ufw<span class="w"> </span>reload
</code></pre>
</div></li>
</ol>

<h3 id="65-nginx-configuration-for-quickshop">6.5 NGINX Configuration for QuickShop</h3>

<ol>
<li><p><strong>Create a dedicated configuration file</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>nano<span class="w"> </span>/etc/nginx/sites-available/quickshop
</code></pre>
</div></li>
<li><p><strong>Add comprehensive NGINX configuration</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="c1"># Upstream definition for backend API</span>
<span class="k">upstream</span><span class="w"> </span><span class="s">backend</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">server</span><span class="w"> </span><span class="n">localhost</span><span class="p">:</span><span class="mi">5000</span><span class="p">;</span>
<span class="w">    </span><span class="kn">keepalive</span><span class="w"> </span><span class="mi">32</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1"># Main server configuration</span>
<span class="k">server</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">listen</span><span class="w"> </span><span class="mi">80</span><span class="p">;</span>
<span class="w">    </span><span class="kn">server_name</span><span class="w"> </span><span class="s">quickshop.echelonxventures.org</span><span class="w"> </span><span class="s">www.quickshop.echelonxventures.org</span><span class="p">;</span>

<span class="w">    </span><span class="c1"># Security headers</span>
<span class="w">    </span><span class="kn">add_header</span><span class="w"> </span><span class="s">X-Frame-Options</span><span class="w"> </span><span class="s">&quot;SAMEORIGIN&quot;</span><span class="w"> </span><span class="s">always</span><span class="p">;</span>
<span class="w">    </span><span class="kn">add_header</span><span class="w"> </span><span class="s">X-XSS-Protection</span><span class="w"> </span><span class="s">&quot;1</span><span class="p">;</span><span class="w"> </span><span class="kn">mode=block&quot;</span><span class="w"> </span><span class="s">always</span><span class="p">;</span>
<span class="w">    </span><span class="kn">add_header</span><span class="w"> </span><span class="s">X-Content-Type-Options</span><span class="w"> </span><span class="s">&quot;nosniff&quot;</span><span class="w"> </span><span class="s">always</span><span class="p">;</span>
<span class="w">    </span><span class="kn">add_header</span><span class="w"> </span><span class="s">Referrer-Policy</span><span class="w"> </span><span class="s">&quot;no-referrer-when-downgrade&quot;</span><span class="w"> </span><span class="s">always</span><span class="p">;</span>
<span class="w">    </span><span class="kn">add_header</span><span class="w"> </span><span class="s">Content-Security-Policy</span><span class="w"> </span><span class="s">&quot;default-src</span><span class="w"> </span><span class="s">&#39;self&#39;</span><span class="w"> </span><span class="s">http:</span><span class="w"> </span><span class="s">https:</span><span class="w"> </span><span class="s">data:</span><span class="w"> </span><span class="s">blob:</span><span class="w"> </span><span class="s">&#39;unsafe-inline&#39;&quot;</span><span class="w"> </span><span class="s">always</span><span class="p">;</span>

<span class="w">    </span><span class="c1"># Client max body size for file uploads</span>
<span class="w">    </span><span class="kn">client_max_body_size</span><span class="w"> </span><span class="s">10M</span><span class="p">;</span>

<span class="w">    </span><span class="c1"># Gzip compression for better performance</span>
<span class="w">    </span><span class="kn">gzip</span><span class="w"> </span><span class="no">on</span><span class="p">;</span>
<span class="w">    </span><span class="kn">gzip_vary</span><span class="w"> </span><span class="no">on</span><span class="p">;</span>
<span class="w">    </span><span class="kn">gzip_min_length</span><span class="w"> </span><span class="mi">1024</span><span class="p">;</span>
<span class="w">    </span><span class="kn">gzip_types</span><span class="w"> </span><span class="s">text/plain</span><span class="w"> </span><span class="s">text/css</span><span class="w"> </span><span class="s">application/json</span><span class="w"> </span><span class="s">application/javascript</span><span class="w"> </span><span class="s">text/xml</span><span class="w"> </span><span class="s">application/xml</span><span class="w"> </span><span class="s">application/xml+rss</span><span class="w"> </span><span class="s">text/javascript</span><span class="p">;</span>

<span class="w">    </span><span class="c1"># Main frontend application (customer-facing)</span>
<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kn">alias</span><span class="w"> </span><span class="s">/home/ubuntu/quickshop/frontend/build/</span><span class="p">;</span>
<span class="w">        </span><span class="kn">try_files</span><span class="w"> </span><span class="nv">$uri</span><span class="w"> </span><span class="nv">$uri/</span><span class="w"> </span><span class="s">@fallback</span><span class="p">;</span>
<span class="w">        </span><span class="kn">expires</span><span class="w"> </span><span class="s">1y</span><span class="p">;</span>
<span class="w">        </span><span class="kn">add_header</span><span class="w"> </span><span class="s">Cache-Control</span><span class="w"> </span><span class="s">&quot;public,</span><span class="w"> </span><span class="s">immutable&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1"># Fallback for Single Page Application routing</span>
<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">@fallback</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kn">alias</span><span class="w"> </span><span class="s">/home/ubuntu/quickshop/frontend/build/index.html</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1"># API proxy to backend</span>
<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/api</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="s">http://backend</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_http_version</span><span class="w"> </span><span class="mi">1</span><span class="s">.1</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">Upgrade</span><span class="w"> </span><span class="nv">$http_upgrade</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">Connection</span><span class="w"> </span><span class="s">&#39;upgrade&#39;</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">Host</span><span class="w"> </span><span class="nv">$host</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Real-IP</span><span class="w"> </span><span class="nv">$remote_addr</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Forwarded-For</span><span class="w"> </span><span class="nv">$proxy_add_x_forwarded_for</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Forwarded-Proto</span><span class="w"> </span><span class="nv">$scheme</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_cache_bypass</span><span class="w"> </span><span class="nv">$http_upgrade</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_connect_timeout</span><span class="w"> </span><span class="s">60s</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_send_timeout</span><span class="w"> </span><span class="s">60s</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_read_timeout</span><span class="w"> </span><span class="s">60s</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1"># WebSocket connections for real-time features</span>
<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/ws</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="s">http://backend</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_http_version</span><span class="w"> </span><span class="mi">1</span><span class="s">.1</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">Upgrade</span><span class="w"> </span><span class="nv">$http_upgrade</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">Connection</span><span class="w"> </span><span class="s">&quot;upgrade&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">Host</span><span class="w"> </span><span class="nv">$host</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Real-IP</span><span class="w"> </span><span class="nv">$remote_addr</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Forwarded-For</span><span class="w"> </span><span class="nv">$proxy_add_x_forwarded_for</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Forwarded-Proto</span><span class="w"> </span><span class="nv">$scheme</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1"># Admin portal</span>
<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/admin</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kn">alias</span><span class="w"> </span><span class="s">/home/ubuntu/quickshop/admin_portal/build/</span><span class="p">;</span>
<span class="w">        </span><span class="kn">try_files</span><span class="w"> </span><span class="nv">$uri</span><span class="w"> </span><span class="nv">$uri/</span><span class="w"> </span><span class="s">@admin_fallback</span><span class="p">;</span>
<span class="w">        </span><span class="kn">expires</span><span class="w"> </span><span class="s">1y</span><span class="p">;</span>
<span class="w">        </span><span class="kn">add_header</span><span class="w"> </span><span class="s">Cache-Control</span><span class="w"> </span><span class="s">&quot;public,</span><span class="w"> </span><span class="s">immutable&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">@admin_fallback</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kn">alias</span><span class="w"> </span><span class="s">/home/ubuntu/quickshop/admin_portal/build/index.html</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1"># Seller portal</span>
<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/seller</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kn">alias</span><span class="w"> </span><span class="s">/home/ubuntu/quickshop/seller_portal/build/</span><span class="p">;</span>
<span class="w">        </span><span class="kn">try_files</span><span class="w"> </span><span class="nv">$uri</span><span class="w"> </span><span class="nv">$uri/</span><span class="w"> </span><span class="s">@seller_fallback</span><span class="p">;</span>
<span class="w">        </span><span class="kn">expires</span><span class="w"> </span><span class="s">1y</span><span class="p">;</span>
<span class="w">        </span><span class="kn">add_header</span><span class="w"> </span><span class="s">Cache-Control</span><span class="w"> </span><span class="s">&quot;public,</span><span class="w"> </span><span class="s">immutable&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">@seller_fallback</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kn">alias</span><span class="w"> </span><span class="s">/home/ubuntu/quickshop/seller_portal/build/index.html</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1"># Support portal</span>
<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/support</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kn">alias</span><span class="w"> </span><span class="s">/home/ubuntu/quickshop/support_portal/build/</span><span class="p">;</span>
<span class="w">        </span><span class="kn">try_files</span><span class="w"> </span><span class="nv">$uri</span><span class="w"> </span><span class="nv">$uri/</span><span class="w"> </span><span class="s">@support_fallback</span><span class="p">;</span>
<span class="w">        </span><span class="kn">expires</span><span class="w"> </span><span class="s">1y</span><span class="p">;</span>
<span class="w">        </span><span class="kn">add_header</span><span class="w"> </span><span class="s">Cache-Control</span><span class="w"> </span><span class="s">&quot;public,</span><span class="w"> </span><span class="s">immutable&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">@support_fallback</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kn">alias</span><span class="w"> </span><span class="s">/home/ubuntu/quickshop/support_portal/build/index.html</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1"># Analytics portal</span>
<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/analytics</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kn">alias</span><span class="w"> </span><span class="s">/home/ubuntu/quickshop/analytics_portal/build/</span><span class="p">;</span>
<span class="w">        </span><span class="kn">try_files</span><span class="w"> </span><span class="nv">$uri</span><span class="w"> </span><span class="nv">$uri/</span><span class="w"> </span><span class="s">@analytics_fallback</span><span class="p">;</span>
<span class="w">        </span><span class="kn">expires</span><span class="w"> </span><span class="s">1y</span><span class="p">;</span>
<span class="w">        </span><span class="kn">add_header</span><span class="w"> </span><span class="s">Cache-Control</span><span class="w"> </span><span class="s">&quot;public,</span><span class="w"> </span><span class="s">immutable&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">@analytics_fallback</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kn">alias</span><span class="w"> </span><span class="s">/home/ubuntu/quickshop/analytics_portal/build/index.html</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1"># Static assets optimization</span>
<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="p">~</span><span class="sr">*</span><span class="w"> </span><span class="s">\.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)</span>$<span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kn">expires</span><span class="w"> </span><span class="s">1y</span><span class="p">;</span>
<span class="w">        </span><span class="kn">add_header</span><span class="w"> </span><span class="s">Cache-Control</span><span class="w"> </span><span class="s">&quot;public,</span><span class="w"> </span><span class="s">immutable&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1"># Security: Hide nginx version</span>
<span class="w">    </span><span class="kn">server_tokens</span><span class="w"> </span><span class="no">off</span><span class="p">;</span>

<span class="w">    </span><span class="c1"># Logging</span>
<span class="w">    </span><span class="kn">access_log</span><span class="w"> </span><span class="s">/var/log/nginx/quickshop_access.log</span><span class="p">;</span>
<span class="w">    </span><span class="kn">error_log</span><span class="w"> </span><span class="s">/var/log/nginx/quickshop_error.log</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div></li>
<li><p><strong>Test the configuration for syntax errors</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>nginx<span class="w"> </span>-t
</code></pre>
</div>

<p>You should see "test is successful" if there are no errors.</p></li>
<li><p><strong>Enable the site configuration</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>ln<span class="w"> </span>-s<span class="w"> </span>/etc/nginx/sites-available/quickshop<span class="w"> </span>/etc/nginx/sites-enabled/
</code></pre>
</div></li>
<li><p><strong>Disable the default NGINX site</strong> (to avoid conflicts):</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>rm<span class="w"> </span>/etc/nginx/sites-enabled/default
</code></pre>
</div></li>
<li><p><strong>Restart NGINX to apply changes</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>nginx
</code></pre>
</div></li>
</ol>

<h3 id="66-frontend-deployment-verification">6.6 Frontend Deployment Verification</h3>

<ol>
<li><p><strong>Check NGINX status</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>status<span class="w"> </span>nginx
</code></pre>
</div></li>
<li><p><strong>Verify configuration</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>nginx<span class="w"> </span>-t
</code></pre>
</div></li>
<li><p><strong>Test site accessibility</strong>:</p>

<div class="codehilite">
<pre><span></span><code>curl<span class="w"> </span>-I<span class="w"> </span>http://quickshop.echelonxventures.org
</code></pre>
</div>

<p>You should see HTTP/1.1 200 OK or a redirect response.</p></li>
<li><p><strong>Check if the frontend files are being served</strong>:</p>

<div class="codehilite">
<pre><span></span><code>curl<span class="w"> </span>-s<span class="w"> </span>http://quickshop.echelonxventures.org<span class="w"> </span><span class="p">|</span><span class="w"> </span>head<span class="w"> </span>-20
</code></pre>
</div>

<p>You should see the HTML structure of your frontend application.</p></li>
<li><p><strong>Test API proxy</strong>:</p>

<div class="codehilite">
<pre><span></span><code>curl<span class="w"> </span>-I<span class="w"> </span>http://quickshop.echelonxventures.org/api/health
</code></pre>
</div>

<p>This should return the backend health check response.</p></li>
<li><p><strong>Check NGINX error logs</strong> if there are issues:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>tail<span class="w"> </span>-f<span class="w"> </span>/var/log/nginx/quickshop_error.log
</code></pre>
</div></li>
</ol>

<h3 id="67-common-frontend-deployment-issues-and-solutions">6.7 Common Frontend Deployment Issues and Solutions</h3>

<p><strong>Build fails with memory issues</strong>:
- Add temporary swap space as shown above
- Use <code>export NODE_OPTIONS="--max_old_space_size=4096"</code> before npm commands</p>

<p><strong>Static files not loading</strong>:
- Verify file permissions: <code>ls -la ~/quickshop/frontend/build/</code>
- Check NGINX configuration paths: <code>sudo nginx -t</code></p>

<p><strong>API calls not working</strong>:
- Verify backend is running: <code>pm2 status</code>
- Check backend logs: <code>pm2 logs quickshop-backend</code>
- Verify NGINX proxy configuration</p>

<p><strong>SSL/HTTPS issues</strong> (to be fixed in next section):
- Initially access via HTTP until SSL is configured
- Ensure all configurations will work with HTTPS after SSL setup</p>

<p><strong>Slow loading times</strong>:
- Verify gzip compression is working in NGINX
- Check cache headers are properly set
- Optimize images and assets if needed</p>

<hr />

<h2 id="7-ssl-configuration-7-ssl-configuration">7. SSL Configuration {#7-ssl-configuration}</h2>

<h3 id="71-install-certbot-and-ssl-prerequisites">7.1 Install Certbot and SSL Prerequisites</h3>

<ol>
<li><p><strong>Update your system packages</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>update
</code></pre>
</div></li>
<li><p><strong>Install Certbot and the NGINX plugin</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>certbot<span class="w"> </span>python3-certbot-nginx<span class="w"> </span>-y
</code></pre>
</div></li>
<li><p><strong>Verify installation</strong>:</p>

<div class="codehilite">
<pre><span></span><code>certbot<span class="w"> </span>--version
</code></pre>
</div></li>
<li><p><strong>Ensure NGINX configuration is correct before SSL setup</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>nginx<span class="w"> </span>-t
</code></pre>
</div></li>
<li><p><strong>Restart NGINX if needed</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>nginx
</code></pre>
</div></li>
</ol>

<h3 id="72-ssl-certificate-configuration-and-obtainment">7.2 SSL Certificate Configuration and Obtainment</h3>

<ol>
<li><p><strong>Verify domain is accessible via HTTP first</strong> (important for certificate validation):</p>

<div class="codehilite">
<pre><span></span><code>curl<span class="w"> </span>-I<span class="w"> </span>http://quickshop.echelonxventures.org
curl<span class="w"> </span>-I<span class="w"> </span>http://www.quickshop.echelonxventures.org
</code></pre>
</div>

<p>Both should return 200 OK status.</p></li>
<li><p><strong>Run Certbot to obtain SSL certificate</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>certbot<span class="w"> </span>--nginx<span class="w"> </span>-d<span class="w"> </span>quickshop.echelonxventures.org<span class="w"> </span>-d<span class="w"> </span>www.quickshop.echelonxventures.org
</code></pre>
</div></li>
<li><p><strong>Follow the prompts during certificate setup</strong>:</p>

<ul>
<li><strong>Enter your email address</strong>: Provide a valid email for security notices</li>
<li><strong>Agree to the Terms of Service</strong>: Type 'A' or 'Y' to agree</li>
<li><strong>Share email with EFF (optional)</strong>: Choose Y or N based on your preference</li>
<li><strong>Redirect HTTP to HTTPS</strong>: Choose option 2 to redirect all traffic to HTTPS (recommended for security)</li>
</ul></li>
<li><p><strong>Verify certificate was obtained successfully</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>ls<span class="w"> </span>-la<span class="w"> </span>/etc/letsencrypt/live/quickshop.echelonxventures.org/
</code></pre>
</div>

<p>You should see: <code>cert.pem</code>, <code>chain.pem</code>, <code>fullchain.pem</code>, and <code>privkey.pem</code></p></li>
</ol>

<h3 id="73-certbot-configuration-verification">7.3 Certbot Configuration Verification</h3>

<ol>
<li><p><strong>Check the updated NGINX configuration</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>cat<span class="w"> </span>/etc/nginx/sites-enabled/quickshop
</code></pre>
</div>

<p>You should see the configuration has been updated to include SSL settings.</p></li>
<li><p><strong>Test the NGINX configuration after SSL changes</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>nginx<span class="w"> </span>-t
</code></pre>
</div></li>
<li><p><strong>Restart NGINX to ensure SSL is properly configured</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>nginx
</code></pre>
</div></li>
<li><p><strong>Check the SSL certificate information</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>certbot<span class="w"> </span>certificates
</code></pre>
</div></li>
</ol>

<h3 id="74-ssl-security-enhancements">7.4 SSL Security Enhancements</h3>

<ol>
<li><p><strong>Create Diffie-Hellman parameters for stronger encryption</strong> (optional but recommended):</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>openssl<span class="w"> </span>dhparam<span class="w"> </span>-out<span class="w"> </span>/etc/nginx/dhparam.pem<span class="w"> </span><span class="m">2048</span>
</code></pre>
</div>

<p><strong>Note</strong>: This may take 10-20 minutes to complete.</p></li>
<li><p><strong>Update NGINX configuration to include security enhancements</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>nano<span class="w"> </span>/etc/nginx/sites-available/quickshop
</code></pre>
</div>

<p>Add SSL-related configuration before the server block or in the main config:</p>

<div class="codehilite">
<pre><span></span><code><span class="c1"># Add these lines at the top of the file or in the main nginx.conf</span>
<span class="c1"># SSL Security Parameters</span>
<span class="k">ssl_protocols</span><span class="w"> </span><span class="s">TLSv1.2</span><span class="w"> </span><span class="s">TLSv1.3</span><span class="p">;</span>
<span class="k">ssl_ciphers</span><span class="w"> </span><span class="s">ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384</span><span class="p">;</span>
<span class="k">ssl_prefer_server_ciphers</span><span class="w"> </span><span class="no">off</span><span class="p">;</span>
<span class="k">ssl_session_cache</span><span class="w"> </span><span class="s">shared:SSL:10m</span><span class="p">;</span>
<span class="k">ssl_session_timeout</span><span class="w"> </span><span class="mi">10m</span><span class="p">;</span>
<span class="k">ssl_session_tickets</span><span class="w"> </span><span class="no">off</span><span class="p">;</span>

<span class="c1"># OCSP Stapling</span>
<span class="k">ssl_stapling</span><span class="w"> </span><span class="no">on</span><span class="p">;</span>
<span class="k">ssl_stapling_verify</span><span class="w"> </span><span class="no">on</span><span class="p">;</span>
<span class="k">resolver</span><span class="w"> </span><span class="mi">8</span><span class="s">.8.8.8</span><span class="w"> </span><span class="mi">8</span><span class="s">.8.4.4</span><span class="w"> </span><span class="s">valid=300s</span><span class="p">;</span>
<span class="k">resolver_timeout</span><span class="w"> </span><span class="s">5s</span><span class="p">;</span>
</code></pre>
</div>

<p>Then modify your server configuration to include these SSL parameters:</p>

<div class="codehilite">
<pre><span></span><code><span class="k">server</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">listen</span><span class="w"> </span><span class="mi">443</span><span class="w"> </span><span class="s">ssl</span><span class="w"> </span><span class="s">http2</span><span class="p">;</span>
<span class="w">    </span><span class="kn">server_name</span><span class="w"> </span><span class="s">quickshop.echelonxventures.org</span><span class="w"> </span><span class="s">www.quickshop.echelonxventures.org</span><span class="p">;</span>

<span class="w">    </span><span class="c1"># SSL Configuration</span>
<span class="w">    </span><span class="kn">ssl_certificate</span><span class="w"> </span><span class="s">/etc/letsencrypt/live/quickshop.echelonxventures.org/fullchain.pem</span><span class="p">;</span>
<span class="w">    </span><span class="kn">ssl_certificate_key</span><span class="w"> </span><span class="s">/etc/letsencrypt/live/quickshop.echelonxventures.org/privkey.pem</span><span class="p">;</span>
<span class="w">    </span><span class="kn">ssl_trusted_certificate</span><span class="w"> </span><span class="s">/etc/letsencrypt/live/quickshop.echelonxventures.org/chain.pem</span><span class="p">;</span>

<span class="w">    </span><span class="c1"># SSL Security Parameters</span>
<span class="w">    </span><span class="kn">ssl_protocols</span><span class="w"> </span><span class="s">TLSv1.2</span><span class="w"> </span><span class="s">TLSv1.3</span><span class="p">;</span>
<span class="w">    </span><span class="kn">ssl_ciphers</span><span class="w"> </span><span class="s">ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384</span><span class="p">;</span>
<span class="w">    </span><span class="kn">ssl_prefer_server_ciphers</span><span class="w"> </span><span class="no">off</span><span class="p">;</span>
<span class="w">    </span><span class="kn">ssl_session_cache</span><span class="w"> </span><span class="s">shared:SSL:10m</span><span class="p">;</span>
<span class="w">    </span><span class="kn">ssl_session_timeout</span><span class="w"> </span><span class="mi">10m</span><span class="p">;</span>
<span class="w">    </span><span class="kn">ssl_session_tickets</span><span class="w"> </span><span class="no">off</span><span class="p">;</span>

<span class="w">    </span><span class="c1"># HSTS (HTTP Strict Transport Security)</span>
<span class="w">    </span><span class="kn">add_header</span><span class="w"> </span><span class="s">Strict-Transport-Security</span><span class="w"> </span><span class="s">&quot;max-age=31536000</span><span class="p">;</span><span class="w"> </span><span class="kn">includeSubDomains&quot;</span><span class="w"> </span><span class="s">always</span><span class="p">;</span>

<span class="w">    </span><span class="c1"># OCSP Stapling</span>
<span class="w">    </span><span class="kn">ssl_stapling</span><span class="w"> </span><span class="no">on</span><span class="p">;</span>
<span class="w">    </span><span class="kn">ssl_stapling_verify</span><span class="w"> </span><span class="no">on</span><span class="p">;</span>
<span class="w">    </span><span class="kn">resolver</span><span class="w"> </span><span class="mi">8</span><span class="s">.8.8.8</span><span class="w"> </span><span class="mi">8</span><span class="s">.8.4.4</span><span class="w"> </span><span class="s">valid=300s</span><span class="p">;</span>
<span class="w">    </span><span class="kn">resolver_timeout</span><span class="w"> </span><span class="s">5s</span><span class="p">;</span>

<span class="w">    </span><span class="c1"># Security headers</span>
<span class="w">    </span><span class="kn">add_header</span><span class="w"> </span><span class="s">X-Frame-Options</span><span class="w"> </span><span class="s">&quot;SAMEORIGIN&quot;</span><span class="w"> </span><span class="s">always</span><span class="p">;</span>
<span class="w">    </span><span class="kn">add_header</span><span class="w"> </span><span class="s">X-XSS-Protection</span><span class="w"> </span><span class="s">&quot;1</span><span class="p">;</span><span class="w"> </span><span class="kn">mode=block&quot;</span><span class="w"> </span><span class="s">always</span><span class="p">;</span>
<span class="w">    </span><span class="kn">add_header</span><span class="w"> </span><span class="s">X-Content-Type-Options</span><span class="w"> </span><span class="s">&quot;nosniff&quot;</span><span class="w"> </span><span class="s">always</span><span class="p">;</span>
<span class="w">    </span><span class="kn">add_header</span><span class="w"> </span><span class="s">Referrer-Policy</span><span class="w"> </span><span class="s">&quot;no-referrer-when-downgrade&quot;</span><span class="w"> </span><span class="s">always</span><span class="p">;</span>
<span class="w">    </span><span class="kn">add_header</span><span class="w"> </span><span class="s">Content-Security-Policy</span><span class="w"> </span><span class="s">&quot;default-src</span><span class="w"> </span><span class="s">&#39;self&#39;</span><span class="w"> </span><span class="s">http:</span><span class="w"> </span><span class="s">https:</span><span class="w"> </span><span class="s">data:</span><span class="w"> </span><span class="s">blob:</span><span class="w"> </span><span class="s">&#39;unsafe-inline&#39;&quot;</span><span class="w"> </span><span class="s">always</span><span class="p">;</span>

<span class="w">    </span><span class="c1"># Rest of your configuration from the previous section...</span>
<span class="p">}</span>
</code></pre>
</div>

<p><strong>Note</strong>: If you choose to manually edit the configuration, make sure to preserve the existing location blocks and backend proxy settings.</p></li>
<li><p><strong>If you manually edited the configuration, test and restart NGINX</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>nginx<span class="w"> </span>-t
sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>nginx
</code></pre>
</div></li>
</ol>

<h3 id="75-ssl-certificate-auto-renewal-setup">7.5 SSL Certificate Auto-Renewal Setup</h3>

<ol>
<li><p><strong>Test certificate renewal process</strong> (without actually renewing):</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>certbot<span class="w"> </span>renew<span class="w"> </span>--dry-run
</code></pre>
</div>

<p>This ensures the renewal process will work properly without actually updating your certificates.</p></li>
<li><p><strong>Set up automatic renewal with cron</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>crontab<span class="w"> </span>-e
</code></pre>
</div></li>
<li><p><strong>Add the following lines</strong> to schedule renewal checks twice daily (recommended for Let's Encrypt):</p>

<pre><code># Renew SSL certificates twice daily (at 2:30 AM and 2:30 PM)
30 2,14 * * * /usr/bin/certbot renew --quiet --post-hook "systemctl reload nginx"
</code></pre>

<p>Or use the traditional once-weekly approach:</p>

<pre><code># Renew SSL certificates weekly on Sundays at 2:30 AM
30 2 * * 0 /usr/bin/certbot renew --quiet --post-hook "systemctl reload nginx"
</code></pre></li>
<li><p><strong>Verify the cron job was added</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>crontab<span class="w"> </span>-l
</code></pre>
</div></li>
</ol>

<h3 id="76-ssl-configuration-verification">7.6 SSL Configuration Verification</h3>

<ol>
<li><p><strong>Test SSL certificate installation</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>openssl<span class="w"> </span>s_client<span class="w"> </span>-connect<span class="w"> </span>quickshop.echelonxventures.org:443<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="p">|</span><span class="w"> </span>openssl<span class="w"> </span>x509<span class="w"> </span>-noout<span class="w"> </span>-dates
</code></pre>
</div>

<p>This shows certificate validity dates.</p></li>
<li><p><strong>Test HTTPS site accessibility</strong>:</p>

<div class="codehilite">
<pre><span></span><code>curl<span class="w"> </span>-I<span class="w"> </span>https://quickshop.echelonxventures.org
</code></pre>
</div>

<p>You should see HTTP/1.1 200 OK or appropriate redirect response.</p></li>
<li><p><strong>Verify HTTP to HTTPS redirect</strong>:</p>

<div class="codehilite">
<pre><span></span><code>curl<span class="w"> </span>-I<span class="w"> </span>http://quickshop.echelonxventures.org
</code></pre>
</div>

<p>This should return a 301 or 302 redirect to HTTPS.</p></li>
<li><p><strong>Test SSL certificate details with online tools</strong>:</p>

<ul>
<li>Visit <a href="https://www.ssllabs.com/ssltest/">SSL Labs SSL Test</a></li>
<li>Enter <code>quickshop.echelonxventures.org</code></li>
<li>This provides detailed SSL configuration analysis</li>
</ul></li>
<li><p><strong>Check backend API still works through proxy</strong>:</p>

<div class="codehilite">
<pre><span></span><code>curl<span class="w"> </span>-I<span class="w"> </span>https://quickshop.echelonxventures.org/api/health
</code></pre>
</div></li>
</ol>

<h3 id="77-ssl-troubleshooting">7.7 SSL Troubleshooting</h3>

<p><strong>Certificate validation failures</strong>:
- Ensure your domain DNS is properly configured
- Check if port 80 is accessible from external sources
- Verify firewall rules allow HTTP traffic</p>

<p><strong>Renewal failures</strong>:
- Test renewal with: <code>sudo certbot renew --dry-run</code>
- Check cron logs: <code>sudo grep -i certbot /var/log/syslog</code>
- Ensure domain still resolves to your server</p>

<p><strong>Mixed content warnings</strong>:
- Update all frontend code to use HTTPS URLs
- Ensure all API calls go through the correct proxy path
- Check browser console for mixed content errors</p>

<p><strong>NGINX SSL errors</strong>:
- Check NGINX error logs: <code>sudo tail -f /var/log/nginx/error.log</code>
- Test configuration: <code>sudo nginx -t</code>
- Check certificate permissions: <code>sudo ls -la /etc/letsencrypt/live/</code></p>

<h3 id="78-security-best-practices">7.8 Security Best Practices</h3>

<ol>
<li><p><strong>Regular monitoring</strong>:</p>

<ul>
<li>Set up alerts for certificate expiration</li>
<li>Monitor SSL/TLS configuration for security updates</li>
</ul></li>
<li><p><strong>Backup certificates</strong> (optional but recommended):</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>cp<span class="w"> </span>-r<span class="w"> </span>/etc/letsencrypt<span class="w"> </span>/home/ubuntu/letsencrypt-backup-<span class="k">$(</span>date<span class="w"> </span>+%F<span class="k">)</span>
</code></pre>
</div></li>
<li><p><strong>Keep Certbot updated</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sudo<span class="w"> </span>apt<span class="w"> </span>upgrade<span class="w"> </span>certbot
</code></pre>
</div></li>
</ol>

<hr />

<h2 id="8-auto-deployment-setup-8-auto-deployment-setup">8. Auto-deployment Setup {#8-auto-deployment-setup}</h2>

<h3 id="81-preparing-for-auto-deployment">8.1 Preparing for Auto-Deployment</h3>

<ol>
<li><p><strong>Verify your GitHub repository</strong>:</p>

<ul>
<li>Ensure your repository is at: https://github.com/echelonxventures/quickshop.git</li>
<li>Verify you have admin access to configure webhooks</li>
<li>Check that your main branch is the default branch (usually "main" or "master")</li>
</ul></li>
<li><p><strong>Install additional tools needed for deployment</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="c1"># Install Git if not already installed</span>
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>git<span class="w"> </span>-y

<span class="c1"># Ensure you have PM2 installed (should already be done)</span>
sudo<span class="w"> </span>npm<span class="w"> </span>install<span class="w"> </span>-g<span class="w"> </span>pm2

<span class="c1"># Install additional tools for deployment</span>
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>jq<span class="w"> </span>-y<span class="w">  </span><span class="c1"># For JSON parsing</span>
</code></pre>
</div></li>
<li><p><strong>Verify current working directory structure</strong>:</p>

<div class="codehilite">
<pre><span></span><code>ls<span class="w"> </span>-la<span class="w"> </span>~/quickshop/
<span class="c1"># Should show: backend/, frontend/, admin_portal/, seller_portal/, support_portal/, analytics_portal/, webhook/, deployment/, ecosystem.config.js</span>
</code></pre>
</div></li>
</ol>

<h3 id="82-webhook-server-implementation">8.2 Webhook Server Implementation</h3>

<ol>
<li><p><strong>Create webhook server directory</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/quickshop
mkdir<span class="w"> </span>-p<span class="w"> </span>webhook
<span class="nb">cd</span><span class="w"> </span>webhook
</code></pre>
</div></li>
<li><p><strong>Create package.json for webhook server</strong>:</p>

<div class="codehilite">
<pre><span></span><code>nano<span class="w"> </span>package.json
</code></pre>
</div>

<p><strong>Content for package.json</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;quickshop-webhook-server&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Webhook server for automatic deployment of QuickShop application&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;main&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;webhook-server.js&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;scripts&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;start&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;node webhook-server.js&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;dev&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;node webhook-server.js&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;dependencies&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;express&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;^4.18.2&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;crypto&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;^1.0.1&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;child_process&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;^1.0.2&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;pm2&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;^5.3.0&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;keywords&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;webhook&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;deployment&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;github&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;auto-deploy&quot;</span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;author&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;QuickShop Team&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;license&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MIT&quot;</span>
<span class="p">}</span>
</code></pre>
</div></li>
<li><p><strong>Install webhook dependencies</strong>:</p>

<div class="codehilite">
<pre><span></span><code>npm<span class="w"> </span>install
</code></pre>
</div></li>
<li><p><strong>Create a more robust webhook server</strong>:</p>

<div class="codehilite">
<pre><span></span><code>nano<span class="w"> </span>webhook-server.js
</code></pre>
</div>

<p><strong>Content for webhook-server.js</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">express</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express&#39;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">crypto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;crypto&#39;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">exec</span><span class="p">,</span><span class="w"> </span><span class="nx">spawn</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;child_process&#39;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">fs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">);</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">app</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">express</span><span class="p">();</span>

<span class="c1">// Use raw body for signature verification</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s1">&#39;/webhook&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">express</span><span class="p">.</span><span class="nx">raw</span><span class="p">({</span><span class="w"> </span><span class="nx">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span><span class="w"> </span><span class="p">}));</span>

<span class="c1">// Parse JSON for other routes</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">json</span><span class="p">());</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">WEBHOOK_SECRET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">WEBHOOK_SECRET</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;default_secret_for_testing&#39;</span><span class="p">;</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">DEPLOYMENT_SCRIPT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DEPLOYMENT_SCRIPT</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;/home/ubuntu/quickshop/deployment/deploy.sh&#39;</span><span class="p">;</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">LOG_DIR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">LOG_DIR</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;/home/ubuntu/quickshop/logs&#39;</span><span class="p">;</span>

<span class="c1">// Ensure log directory exists</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">fs</span><span class="p">.</span><span class="nx">existsSync</span><span class="p">(</span><span class="nx">LOG_DIR</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">fs</span><span class="p">.</span><span class="nx">mkdirSync</span><span class="p">(</span><span class="nx">LOG_DIR</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">recursive</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">});</span>
<span class="p">}</span>

<span class="c1">// Verify GitHub webhook signature</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">verifySignature</span><span class="p">(</span><span class="nx">payload</span><span class="p">,</span><span class="w"> </span><span class="nx">signature</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">signature</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">expectedSignature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;sha256=&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">crypto</span><span class="p">.</span><span class="nx">createHmac</span><span class="p">(</span><span class="s1">&#39;sha256&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">WEBHOOK_SECRET</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">payload</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="nx">digest</span><span class="p">(</span><span class="s1">&#39;hex&#39;</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Use timing-safe comparison</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">crypto</span><span class="p">.</span><span class="nx">timingSafeEqual</span><span class="p">(</span>
<span class="w">        </span><span class="nx">Buffer</span><span class="p">.</span><span class="kr">from</span><span class="p">(</span><span class="nx">signature</span><span class="p">),</span>
<span class="w">        </span><span class="nx">Buffer</span><span class="p">.</span><span class="kr">from</span><span class="p">(</span><span class="nx">expectedSignature</span><span class="p">)</span>
<span class="w">    </span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Log function</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">logMessage</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span><span class="w"> </span><span class="nx">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;INFO&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">timestamp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">().</span><span class="nx">toISOString</span><span class="p">();</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">logEntry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`[</span><span class="si">${</span><span class="nx">timestamp</span><span class="si">}</span><span class="sb">] [</span><span class="si">${</span><span class="nx">type</span><span class="si">}</span><span class="sb">] </span><span class="si">${</span><span class="nx">message</span><span class="si">}</span><span class="sb">\n`</span><span class="p">;</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">logEntry</span><span class="p">.</span><span class="nx">trim</span><span class="p">());</span>

<span class="w">    </span><span class="c1">// Write to log file</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">logFilePath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">LOG_DIR</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;webhook.log&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">fs</span><span class="p">.</span><span class="nx">appendFileSync</span><span class="p">(</span><span class="nx">logFilePath</span><span class="p">,</span><span class="w"> </span><span class="nx">logEntry</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Webhook endpoint</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">&#39;/webhook&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">req</span><span class="p">,</span><span class="w"> </span><span class="nx">res</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">signature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">req</span><span class="p">.</span><span class="nx">headers</span><span class="p">[</span><span class="s1">&#39;x-hub-signature-256&#39;</span><span class="p">];</span>

<span class="w">    </span><span class="nx">logMessage</span><span class="p">(</span><span class="s1">&#39;Received webhook request&#39;</span><span class="p">);</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">signature</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">logMessage</span><span class="p">(</span><span class="s1">&#39;No signature provided&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ERROR&#39;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">401</span><span class="p">).</span><span class="nx">send</span><span class="p">(</span><span class="s1">&#39;No signature provided&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">verifySignature</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">,</span><span class="w"> </span><span class="nx">signature</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">logMessage</span><span class="p">(</span><span class="s1">&#39;Invalid signature&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ERROR&#39;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">401</span><span class="p">).</span><span class="nx">send</span><span class="p">(</span><span class="s1">&#39;Invalid signature&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Parse the webhook payload</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">payload</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Only deploy on push to main branch</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">payload</span><span class="p">.</span><span class="nx">ref</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;refs/heads/main&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">payload</span><span class="p">.</span><span class="nx">ref</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;refs/heads/master&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">logMessage</span><span class="p">(</span><span class="sb">`Skipping deployment for branch: </span><span class="si">${</span><span class="nx">payload</span><span class="p">.</span><span class="nx">ref</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;INFO&#39;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">200</span><span class="p">).</span><span class="nx">send</span><span class="p">(</span><span class="s1">&#39;Skipping deployment - not main/master branch&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">logMessage</span><span class="p">(</span><span class="sb">`Processing webhook for branch: </span><span class="si">${</span><span class="nx">payload</span><span class="p">.</span><span class="nx">ref</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;INFO&#39;</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Execute deployment script</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">deploymentProcess</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">spawn</span><span class="p">(</span><span class="s1">&#39;bash&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="nx">DEPLOYMENT_SCRIPT</span><span class="p">],</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">detached</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">        </span><span class="nx">stdio</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;pipe&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;pipe&#39;</span><span class="p">]</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">stdout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">stderr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span>

<span class="w">    </span><span class="nx">deploymentProcess</span><span class="p">.</span><span class="nx">stdout</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">stdout</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>
<span class="w">        </span><span class="nx">logMessage</span><span class="p">(</span><span class="sb">`Deployment output: </span><span class="si">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">toString</span><span class="p">().</span><span class="nx">trim</span><span class="p">()</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;INFO&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="nx">deploymentProcess</span><span class="p">.</span><span class="nx">stderr</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">stderr</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>
<span class="w">        </span><span class="nx">logMessage</span><span class="p">(</span><span class="sb">`Deployment error: </span><span class="si">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">toString</span><span class="p">().</span><span class="nx">trim</span><span class="p">()</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ERROR&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="nx">deploymentProcess</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">code</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">logMessage</span><span class="p">(</span><span class="sb">`Deployment process exited with code: </span><span class="si">${</span><span class="nx">code</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span><span class="w"> </span><span class="nx">code</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;INFO&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;ERROR&#39;</span><span class="p">);</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">code</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">200</span><span class="p">).</span><span class="nx">send</span><span class="p">(</span><span class="s1">&#39;Deployment triggered successfully&#39;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">500</span><span class="p">).</span><span class="nx">send</span><span class="p">(</span><span class="s1">&#39;Deployment failed&#39;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="nx">deploymentProcess</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">logMessage</span><span class="p">(</span><span class="sb">`Failed to start deployment: </span><span class="si">${</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ERROR&#39;</span><span class="p">);</span>
<span class="w">        </span><span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">500</span><span class="p">).</span><span class="nx">send</span><span class="p">(</span><span class="s1">&#39;Failed to start deployment process&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>
<span class="p">});</span>

<span class="c1">// Health check endpoint</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/health&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">req</span><span class="p">,</span><span class="w"> </span><span class="nx">res</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">200</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span>
<span class="w">        </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;OK&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">().</span><span class="nx">toISOString</span><span class="p">(),</span>
<span class="w">        </span><span class="nx">service</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Webhook Server&#39;</span>
<span class="w">    </span><span class="p">});</span>
<span class="p">});</span>

<span class="c1">// Status endpoint</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/status&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">req</span><span class="p">,</span><span class="w"> </span><span class="nx">res</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">200</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span>
<span class="w">        </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;RUNNING&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">webhook_secret_set</span><span class="o">:</span><span class="w"> </span><span class="o">!!</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">WEBHOOK_SECRET</span><span class="p">,</span>
<span class="w">        </span><span class="nx">deployment_script</span><span class="o">:</span><span class="w"> </span><span class="nx">DEPLOYMENT_SCRIPT</span><span class="p">,</span>
<span class="w">        </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">().</span><span class="nx">toISOString</span><span class="p">()</span>
<span class="w">    </span><span class="p">});</span>
<span class="p">});</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">PORT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">PORT</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">9000</span><span class="p">;</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="nx">PORT</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">logMessage</span><span class="p">(</span><span class="sb">`Webhook server running on port </span><span class="si">${</span><span class="nx">PORT</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;INFO&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">logMessage</span><span class="p">(</span><span class="sb">`Webhook endpoint: http://0.0.0.0:</span><span class="si">${</span><span class="nx">PORT</span><span class="si">}</span><span class="sb">/webhook`</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;INFO&#39;</span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">// Graceful shutdown</span>
<span class="nx">process</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;SIGTERM&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">logMessage</span><span class="p">(</span><span class="s1">&#39;Received SIGTERM, shutting down gracefully&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;INFO&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mf">0</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">process</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;SIGINT&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">logMessage</span><span class="p">(</span><span class="s1">&#39;Received SIGINT, shutting down gracefully&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;INFO&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mf">0</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
</div></li>
</ol>

<h3 id="83-enhanced-deployment-script">8.3 Enhanced Deployment Script</h3>

<ol>
<li><p><strong>Create deployment directory</strong>:</p>

<div class="codehilite">
<pre><span></span><code>mkdir<span class="w"> </span>-p<span class="w"> </span>~/quickshop/deployment
<span class="nb">cd</span><span class="w"> </span>~/quickshop/deployment
</code></pre>
</div></li>
<li><p><strong>Create a comprehensive deployment script</strong>:</p>

<div class="codehilite">
<pre><span></span><code>nano<span class="w"> </span>deploy.sh
</code></pre>
</div>

<p><strong>Content for deploy.sh</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1">#===============================================================================</span>
<span class="c1"># QuickShop Auto-Deployment Script</span>
<span class="c1">#===============================================================================</span>
<span class="c1"># This script performs a complete auto-deployment of QuickShop application</span>
<span class="c1"># It updates the code, installs dependencies, builds the frontend,</span>
<span class="c1"># and restarts the services.</span>
<span class="c1">#===============================================================================</span>

<span class="nb">set</span><span class="w"> </span>-e<span class="w">  </span><span class="c1"># Exit on any error</span>

<span class="c1"># Configuration</span>
<span class="nv">PROJECT_DIR</span><span class="o">=</span><span class="s2">&quot;/home/ubuntu/quickshop&quot;</span>
<span class="nv">BACKUP_DIR</span><span class="o">=</span><span class="s2">&quot;/home/ubuntu/quickshop-backups&quot;</span>
<span class="nv">LOG_FILE</span><span class="o">=</span><span class="s2">&quot;/home/ubuntu/quickshop/logs/deployment.log&quot;</span>
<span class="nv">TIMESTAMP</span><span class="o">=</span><span class="k">$(</span>date<span class="w"> </span>+<span class="s2">&quot;%Y%m%d_%H%M%S&quot;</span><span class="k">)</span>

<span class="c1"># Function to log messages</span>
log<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;[</span><span class="k">$(</span>date<span class="w"> </span><span class="s1">&#39;+%Y-%m-%d %H:%M:%S&#39;</span><span class="k">)</span><span class="s2">] </span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$LOG_FILE</span><span class="s2">&quot;</span>
<span class="o">}</span>

log<span class="w"> </span><span class="s2">&quot;Starting deployment process...&quot;</span>

<span class="c1"># Function for error handling</span>
error_exit<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span>log<span class="w"> </span><span class="s2">&quot;ERROR: </span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
<span class="o">}</span>

<span class="c1"># Create backup directory if it doesn&#39;t exist</span>
mkdir<span class="w"> </span>-p<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$BACKUP_DIR</span><span class="s2">&quot;</span>
mkdir<span class="w"> </span>-p<span class="w"> </span><span class="s2">&quot;/home/ubuntu/quickshop/logs&quot;</span>

<span class="c1"># Create backup of current version</span>
log<span class="w"> </span><span class="s2">&quot;Creating backup of current version...&quot;</span>
<span class="nv">BACKUP_NAME</span><span class="o">=</span><span class="s2">&quot;quickshop_backup_</span><span class="si">${</span><span class="nv">TIMESTAMP</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nv">BACKUP_PATH</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$BACKUP_DIR</span><span class="s2">/</span><span class="nv">$BACKUP_NAME</span><span class="s2">&quot;</span>
cp<span class="w"> </span>-r<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$PROJECT_DIR</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$BACKUP_PATH</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>log<span class="w"> </span><span class="s2">&quot;Warning: Could not create backup&quot;</span>
log<span class="w"> </span><span class="s2">&quot;Backup created at: </span><span class="nv">$BACKUP_PATH</span><span class="s2">&quot;</span>

<span class="c1"># Navigate to project directory</span>
<span class="nb">cd</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$PROJECT_DIR</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>error_exit<span class="w"> </span><span class="s2">&quot;Could not navigate to project directory&quot;</span>

<span class="c1"># Fetch latest changes from repository</span>
log<span class="w"> </span><span class="s2">&quot;Fetching latest changes from repository...&quot;</span>
git<span class="w"> </span>fetch<span class="w"> </span>origin<span class="w"> </span><span class="o">||</span><span class="w"> </span>error_exit<span class="w"> </span><span class="s2">&quot;Failed to fetch from origin&quot;</span>
git<span class="w"> </span>reset<span class="w"> </span>--hard<span class="w"> </span>origin/main<span class="w"> </span><span class="o">||</span><span class="w"> </span>error_exit<span class="w"> </span><span class="s2">&quot;Failed to reset to origin/main&quot;</span>

<span class="c1"># Verify the correct branch is checked out</span>
<span class="nv">CURRENT_BRANCH</span><span class="o">=</span><span class="k">$(</span>git<span class="w"> </span>branch<span class="w"> </span>--show-current<span class="k">)</span>
log<span class="w"> </span><span class="s2">&quot;Current branch: </span><span class="nv">$CURRENT_BRANCH</span><span class="s2">&quot;</span>

<span class="c1"># Update backend</span>
log<span class="w"> </span><span class="s2">&quot;Updating backend...&quot;</span>
<span class="nb">cd</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$PROJECT_DIR</span><span class="s2">/backend&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>error_exit<span class="w"> </span><span class="s2">&quot;Could not navigate to backend directory&quot;</span>

<span class="c1"># Install backend dependencies</span>
log<span class="w"> </span><span class="s2">&quot;Installing backend dependencies...&quot;</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">NODE_OPTIONS</span><span class="o">=</span><span class="s2">&quot;--max_old_space_size=4096&quot;</span><span class="w">  </span><span class="c1"># Increase memory for build</span>
npm<span class="w"> </span>install<span class="w"> </span>--production<span class="w"> </span><span class="o">||</span><span class="w"> </span>error_exit<span class="w"> </span><span class="s2">&quot;Failed to install backend dependencies&quot;</span>

<span class="c1"># Build backend if needed (for TypeScript or other build steps)</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;tsconfig.json&quot;</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;webpack.config.js&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span>log<span class="w"> </span><span class="s2">&quot;Building backend...&quot;</span>
<span class="w">    </span>npm<span class="w"> </span>run<span class="w"> </span>build<span class="w"> </span><span class="o">||</span><span class="w"> </span>log<span class="w"> </span><span class="s2">&quot;Backend build had issues, continuing...&quot;</span>
<span class="k">fi</span>

<span class="c1"># Update frontend</span>
log<span class="w"> </span><span class="s2">&quot;Updating frontend...&quot;</span>
<span class="nb">cd</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$PROJECT_DIR</span><span class="s2">/frontend&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>error_exit<span class="w"> </span><span class="s2">&quot;Could not navigate to frontend directory&quot;</span>

<span class="c1"># Install frontend dependencies</span>
log<span class="w"> </span><span class="s2">&quot;Installing frontend dependencies...&quot;</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">NODE_OPTIONS</span><span class="o">=</span><span class="s2">&quot;--max_old_space_size=4096&quot;</span><span class="w">  </span><span class="c1"># Increase memory for build</span>
npm<span class="w"> </span>install<span class="w"> </span>--production<span class="w"> </span><span class="o">||</span><span class="w"> </span>error_exit<span class="w"> </span><span class="s2">&quot;Failed to install frontend dependencies&quot;</span>

<span class="c1"># Build frontend</span>
log<span class="w"> </span><span class="s2">&quot;Building frontend...&quot;</span>
npm<span class="w"> </span>run<span class="w"> </span>build<span class="w"> </span><span class="o">||</span><span class="w"> </span>error_exit<span class="w"> </span><span class="s2">&quot;Failed to build frontend&quot;</span>

<span class="c1"># Update admin portal</span>
log<span class="w"> </span><span class="s2">&quot;Updating admin portal...&quot;</span>
<span class="nb">cd</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$PROJECT_DIR</span><span class="s2">/admin_portal&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>error_exit<span class="w"> </span><span class="s2">&quot;Could not navigate to admin portal directory&quot;</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">NODE_OPTIONS</span><span class="o">=</span><span class="s2">&quot;--max_old_space_size=4096&quot;</span>
npm<span class="w"> </span>install<span class="w"> </span>--production<span class="w"> </span><span class="o">||</span><span class="w"> </span>log<span class="w"> </span><span class="s2">&quot;Error installing admin portal dependencies, continuing...&quot;</span>
npm<span class="w"> </span>run<span class="w"> </span>build<span class="w"> </span><span class="o">||</span><span class="w"> </span>log<span class="w"> </span><span class="s2">&quot;Error building admin portal, continuing...&quot;</span>

<span class="c1"># Update support portal</span>
log<span class="w"> </span><span class="s2">&quot;Updating support portal...&quot;</span>
<span class="nb">cd</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$PROJECT_DIR</span><span class="s2">/support_portal&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>error_exit<span class="w"> </span><span class="s2">&quot;Could not navigate to support portal directory&quot;</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">NODE_OPTIONS</span><span class="o">=</span><span class="s2">&quot;--max_old_space_size=4096&quot;</span>
npm<span class="w"> </span>install<span class="w"> </span>--production<span class="w"> </span><span class="o">||</span><span class="w"> </span>log<span class="w"> </span><span class="s2">&quot;Error installing support portal dependencies, continuing...&quot;</span>
npm<span class="w"> </span>run<span class="w"> </span>build<span class="w"> </span><span class="o">||</span><span class="w"> </span>log<span class="w"> </span><span class="s2">&quot;Error building support portal, continuing...&quot;</span>

<span class="c1"># Update analytics portal</span>
log<span class="w"> </span><span class="s2">&quot;Updating analytics portal...&quot;</span>
<span class="nb">cd</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$PROJECT_DIR</span><span class="s2">/analytics_portal&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>error_exit<span class="w"> </span><span class="s2">&quot;Could not navigate to analytics portal directory&quot;</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">NODE_OPTIONS</span><span class="o">=</span><span class="s2">&quot;--max_old_space_size=4096&quot;</span>
npm<span class="w"> </span>install<span class="w"> </span>--production<span class="w"> </span><span class="o">||</span><span class="w"> </span>log<span class="w"> </span><span class="s2">&quot;Error installing analytics portal dependencies, continuing...&quot;</span>
npm<span class="w"> </span>run<span class="w"> </span>build<span class="w"> </span><span class="o">||</span><span class="w"> </span>log<span class="w"> </span><span class="s2">&quot;Error building analytics portal, continuing...&quot;</span>

<span class="c1"># Update seller portal</span>
log<span class="w"> </span><span class="s2">&quot;Updating seller portal...&quot;</span>
<span class="nb">cd</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$PROJECT_DIR</span><span class="s2">/seller_portal&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>error_exit<span class="w"> </span><span class="s2">&quot;Could not navigate to seller portal directory&quot;</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">NODE_OPTIONS</span><span class="o">=</span><span class="s2">&quot;--max_old_space_size=4096&quot;</span>
npm<span class="w"> </span>install<span class="w"> </span>--production<span class="w"> </span><span class="o">||</span><span class="w"> </span>log<span class="w"> </span><span class="s2">&quot;Error installing seller portal dependencies, continuing...&quot;</span>
npm<span class="w"> </span>run<span class="w"> </span>build<span class="w"> </span><span class="o">||</span><span class="w"> </span>log<span class="w"> </span><span class="s2">&quot;Error building seller portal, continuing...&quot;</span>

<span class="c1"># Restart PM2 processes</span>
log<span class="w"> </span><span class="s2">&quot;Restarting PM2 processes...&quot;</span>
<span class="nb">cd</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$PROJECT_DIR</span><span class="s2">&quot;</span>

<span class="c1"># Reload PM2 without downtime</span>
pm2<span class="w"> </span>reload<span class="w"> </span>all<span class="w"> </span><span class="o">||</span><span class="w"> </span>log<span class="w"> </span><span class="s2">&quot;Error reloading PM2, attempting restart...&quot;</span>

<span class="c1"># If reload failed, try individual restart</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$?</span><span class="w"> </span>-ne<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span>pm2<span class="w"> </span>restart<span class="w"> </span>quickshop-backend<span class="w"> </span><span class="o">||</span><span class="w"> </span>log<span class="w"> </span><span class="s2">&quot;Error restarting backend&quot;</span>
<span class="w">    </span>pm2<span class="w"> </span>restart<span class="w"> </span>quickshop-webhook<span class="w"> </span><span class="o">||</span><span class="w"> </span>log<span class="w"> </span><span class="s2">&quot;Error restarting webhook&quot;</span>
<span class="k">fi</span>

<span class="c1"># Run post-deployment checks</span>
log<span class="w"> </span><span class="s2">&quot;Running post-deployment checks...&quot;</span>

<span class="c1"># Check if backend is responding</span>
<span class="nv">BACKEND_STATUS</span><span class="o">=</span><span class="k">$(</span>curl<span class="w"> </span>-s<span class="w"> </span>-o<span class="w"> </span>/dev/null<span class="w"> </span>-w<span class="w"> </span><span class="s2">&quot;%{http_code}&quot;</span><span class="w"> </span>http://localhost:5000/health<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;000&quot;</span><span class="k">)</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$BACKEND_STATUS</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;200&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span>log<span class="w"> </span><span class="s2">&quot; Backend is responding correctly (Status: </span><span class="nv">$BACKEND_STATUS</span><span class="s2">)&quot;</span>
<span class="k">else</span>
<span class="w">    </span>log<span class="w"> </span><span class="s2">&quot; Backend is not responding correctly (Status: </span><span class="nv">$BACKEND_STATUS</span><span class="s2">)&quot;</span>
<span class="k">fi</span>

<span class="c1"># Check if webhook is responding</span>
<span class="nv">WEBHOOK_STATUS</span><span class="o">=</span><span class="k">$(</span>curl<span class="w"> </span>-s<span class="w"> </span>-o<span class="w"> </span>/dev/null<span class="w"> </span>-w<span class="w"> </span><span class="s2">&quot;%{http_code}&quot;</span><span class="w"> </span>http://localhost:9000/health<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;000&quot;</span><span class="k">)</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$WEBHOOK_STATUS</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;200&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span>log<span class="w"> </span><span class="s2">&quot; Webhook server is responding correctly (Status: </span><span class="nv">$WEBHOOK_STATUS</span><span class="s2">)&quot;</span>
<span class="k">else</span>
<span class="w">    </span>log<span class="w"> </span><span class="s2">&quot; Webhook server is not responding correctly (Status: </span><span class="nv">$WEBHOOK_STATUS</span><span class="s2">)&quot;</span>
<span class="k">fi</span>

<span class="c1"># Reload NGINX configuration</span>
log<span class="w"> </span><span class="s2">&quot;Reloading NGINX configuration...&quot;</span>
sudo<span class="w"> </span>nginx<span class="w"> </span>-t<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sudo<span class="w"> </span>systemctl<span class="w"> </span>reload<span class="w"> </span>nginx<span class="w"> </span><span class="o">||</span><span class="w"> </span>error_exit<span class="w"> </span><span class="s2">&quot;Failed to reload NGINX&quot;</span>

<span class="c1"># Clean up old backups (keep last 5)</span>
log<span class="w"> </span><span class="s2">&quot;Cleaning up old backups...&quot;</span>
ls<span class="w"> </span>-t<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$BACKUP_DIR</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>tail<span class="w"> </span>-n<span class="w"> </span>+6<span class="w"> </span><span class="p">|</span><span class="w"> </span>xargs<span class="w"> </span>-I<span class="w"> </span><span class="o">{}</span><span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$BACKUP_DIR</span><span class="s2">/{}&quot;</span><span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="o">||</span><span class="w"> </span>log<span class="w"> </span><span class="s2">&quot;No old backups to remove&quot;</span>

log<span class="w"> </span><span class="s2">&quot;Deployment completed successfully at </span><span class="k">$(</span>date<span class="k">)</span><span class="s2">&quot;</span>
log<span class="w"> </span><span class="s2">&quot;========================================&quot;</span>
</code></pre>
</div></li>
<li><p><strong>Make the deployment script executable</strong>:</p>

<div class="codehilite">
<pre><span></span><code>chmod<span class="w"> </span>+x<span class="w"> </span>deploy.sh
</code></pre>
</div></li>
<li><p><strong>Test the deployment script</strong> (dry run):</p>

<div class="codehilite">
<pre><span></span><code><span class="c1"># Make sure all directories exist before running the script</span>
ls<span class="w"> </span>-la<span class="w"> </span>/home/ubuntu/quickshop/
</code></pre>
</div></li>
</ol>

<h3 id="84-configure-github-webhook">8.4 Configure GitHub Webhook</h3>

<ol>
<li><p><strong>Navigate to your GitHub repository</strong>:</p>

<ul>
<li>Go to https://github.com/echelonxventures/quickshop.git</li>
<li>Click on the "Settings" tab</li>
<li>In the left sidebar, click on "Webhooks"</li>
</ul></li>
<li><p><strong>Generate a secure webhook secret</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="c1"># On your server, generate a secure secret</span>
openssl<span class="w"> </span>rand<span class="w"> </span>-hex<span class="w"> </span><span class="m">32</span>
</code></pre>
</div>

<p>This will generate a 64-character hexadecimal string to use as your webhook secret.</p></li>
<li><p><strong>Add a new webhook</strong>:</p>

<ul>
<li>Click "Add webhook" button</li>
<li><strong>Payload URL</strong>: <code>https://quickshop.echelonxventures.org:9000/webhook</code></li>
<li><strong>Content type</strong>: <code>application/json</code></li>
<li><strong>Secret</strong>: Paste the secret generated above</li>
<li><strong>Events</strong>: Select "Just the push event" or "Let me select individual events" and choose "Pushes"</li>
<li>Click "Add webhook"</li>
</ul></li>
<li><p><strong>Verify webhook is added</strong>:</p>

<ul>
<li>The webhook should appear in the list</li>
<li>Status should show "Recent Deliveries" with a green checkmark after successful setup</li>
</ul></li>
</ol>

<h3 id="85-pm2-configuration-for-webhook-server">8.5 PM2 Configuration for Webhook Server</h3>

<ol>
<li><p><strong>Update the ecosystem.config.js file</strong> in the main quickshop directory:</p>

<div class="codehilite">
<pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/quickshop
nano<span class="w"> </span>ecosystem.config.js
</code></pre>
</div>

<p><strong>Updated content for ecosystem.config.js</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">apps</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;quickshop-backend&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">script</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;./backend/server.js&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">instances</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="c1">// For free tier, limit to 1 instance</span>
<span class="w">      </span><span class="nx">exec_mode</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;fork&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Use fork mode for simpler memory usage</span>
<span class="w">      </span><span class="nx">env</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">NODE_ENV</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;production&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">PORT</span><span class="o">:</span><span class="w"> </span><span class="mf">5000</span><span class="p">,</span>
<span class="w">        </span><span class="nx">HOST</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;0.0.0.0&#39;</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nx">env_file</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;./backend/.env&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">error_file</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;./backend/logs/err.log&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">out_file</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;./backend/logs/out.log&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">log_file</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;./backend/logs/combined.log&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">time</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">      </span><span class="nx">max_memory_restart</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;512M&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">node_args</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;--max-old-space-size=512&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">watch</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">      </span><span class="nx">ignore_watch</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;node_modules&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;logs&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.git&#39;</span><span class="p">],</span>
<span class="w">      </span><span class="nx">exp_backoff_restart_delay</span><span class="o">:</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span>
<span class="w">      </span><span class="nx">max_restarts</span><span class="o">:</span><span class="w"> </span><span class="mf">30</span><span class="p">,</span>
<span class="w">      </span><span class="nx">min_uptime</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;10s&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="c1">// Set environment variables for production</span>
<span class="w">      </span><span class="nx">env_production</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">NODE_ENV</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;production&#39;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;quickshop-webhook&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">script</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;./webhook/webhook-server.js&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">instances</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">      </span><span class="nx">exec_mode</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;fork&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">env</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">NODE_ENV</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;production&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">PORT</span><span class="o">:</span><span class="w"> </span><span class="mf">9000</span><span class="p">,</span>
<span class="w">        </span><span class="nx">WEBHOOK_SECRET</span><span class="o">:</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">WEBHOOK_SECRET</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;your_webhook_secret_here&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">DEPLOYMENT_SCRIPT</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;./deployment/deploy.sh&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">LOG_DIR</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;./logs&#39;</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nx">error_file</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;./logs/webhook-err.log&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">out_file</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;./logs/webhook-out.log&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">log_file</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;./logs/webhook-combined.log&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">time</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">      </span><span class="nx">max_memory_restart</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;256M&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">node_args</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;--max-old-space-size=256&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">watch</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">      </span><span class="nx">ignore_watch</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;node_modules&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;logs&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.git&#39;</span><span class="p">],</span>
<span class="w">      </span><span class="nx">exp_backoff_restart_delay</span><span class="o">:</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span>
<span class="w">      </span><span class="nx">max_restarts</span><span class="o">:</span><span class="w"> </span><span class="mf">10</span><span class="p">,</span>
<span class="w">      </span><span class="nx">min_uptime</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;10s&#39;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">};</span>
</code></pre>
</div></li>
<li><p><strong>Set the webhook secret as an environment variable</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="c1"># Generate a secure secret if you haven&#39;t already</span>
<span class="nv">WEBHOOK_SECRET</span><span class="o">=</span><span class="k">$(</span>openssl<span class="w"> </span>rand<span class="w"> </span>-hex<span class="w"> </span><span class="m">32</span><span class="k">)</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;export WEBHOOK_SECRET=\&quot;</span><span class="nv">$WEBHOOK_SECRET</span><span class="s2">\&quot;&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>~/.bashrc
<span class="nb">source</span><span class="w"> </span>~/.bashrc
</code></pre>
</div></li>
<li><p><strong>Update PM2 with the new configuration</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/quickshop
pm2<span class="w"> </span>delete<span class="w"> </span>all<span class="w">  </span><span class="c1"># Remove any existing processes</span>
pm2<span class="w"> </span>start<span class="w"> </span>ecosystem.config.js
pm2<span class="w"> </span>save
</code></pre>
</div></li>
<li><p><strong>Check that both processes are running</strong>:</p>

<div class="codehilite">
<pre><span></span><code>pm2<span class="w"> </span>status
</code></pre>
</div>

<p>You should see both <code>quickshop-backend</code> and <code>quickshop-webhook</code> as "online".</p></li>
</ol>

<h3 id="86-configure-firewall-for-webhook-port">8.6 Configure Firewall for Webhook Port</h3>

<ol>
<li><p><strong>Open port 9000 for the webhook server</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span><span class="m">9000</span>
sudo<span class="w"> </span>ufw<span class="w"> </span>reload
</code></pre>
</div></li>
<li><p><strong>Verify firewall status</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>ufw<span class="w"> </span>status
</code></pre>
</div></li>
</ol>

<h3 id="87-test-auto-deployment-setup">8.7 Test Auto-Deployment Setup</h3>

<ol>
<li><p><strong>Test webhook server health</strong>:</p>

<div class="codehilite">
<pre><span></span><code>curl<span class="w"> </span>http://localhost:9000/health
curl<span class="w"> </span>http://localhost:9000/status
</code></pre>
</div></li>
<li><p><strong>Test webhook from external source</strong> (simulating GitHub):</p>

<div class="codehilite">
<pre><span></span><code><span class="c1"># Create a simple test payload</span>
cat<span class="w"> </span>&gt;<span class="w"> </span>/tmp/test-payload.json<span class="w"> </span><span class="s">&lt;&lt; EOF</span>
<span class="s">{</span>
<span class="s">  &quot;ref&quot;: &quot;refs/heads/main&quot;,</span>
<span class="s">  &quot;repository&quot;: {</span>
<span class="s">    &quot;name&quot;: &quot;quickshop&quot;,</span>
<span class="s">    &quot;full_name&quot;: &quot;echelonxventures/quickshop&quot;</span>
<span class="s">  }</span>
<span class="s">}</span>
<span class="s">EOF</span>

<span class="c1"># Generate signature (replace YOUR_SECRET with your actual webhook secret)</span>
<span class="nv">SECRET</span><span class="o">=</span><span class="s2">&quot;your_actual_webhook_secret&quot;</span>
<span class="nv">PAYLOAD</span><span class="o">=</span><span class="k">$(</span>cat<span class="w"> </span>/tmp/test-payload.json<span class="k">)</span>
<span class="nv">SIGNATURE</span><span class="o">=</span><span class="s2">&quot;sha256=</span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$PAYLOAD</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>openssl<span class="w"> </span>dgst<span class="w"> </span>-sha256<span class="w"> </span>-hmac<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$SECRET</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span><span class="s1">&#39;s/^.* //&#39;</span><span class="k">)</span><span class="s2">&quot;</span>

<span class="c1"># Send test request</span>
curl<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;X-Hub-Signature-256: </span><span class="nv">$SIGNATURE</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-d<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$PAYLOAD</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>http://localhost:9000/webhook
</code></pre>
</div></li>
<li><p><strong>Check the webhook server logs</strong>:</p>

<div class="codehilite">
<pre><span></span><code>pm2<span class="w"> </span>logs<span class="w"> </span>quickshop-webhook<span class="w"> </span>--lines<span class="w"> </span><span class="m">50</span>
</code></pre>
</div></li>
<li><p><strong>Test the deployment script directly</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/quickshop/deployment
bash<span class="w"> </span>deploy.sh
</code></pre>
</div></li>
</ol>

<h3 id="88-auto-deployment-verification-and-troubleshooting">8.8 Auto-deployment Verification and Troubleshooting</h3>

<ol>
<li><p><strong>Check deployment logs</strong>:</p>

<div class="codehilite">
<pre><span></span><code>cat<span class="w"> </span>~/quickshop/logs/deployment.log
</code></pre>
</div></li>
<li><p><strong>Monitor PM2 logs</strong>:</p>

<div class="codehilite">
<pre><span></span><code>pm2<span class="w"> </span>logs
<span class="c1"># Or monitor specific services</span>
pm2<span class="w"> </span>logs<span class="w"> </span>quickshop-webhook
pm2<span class="w"> </span>logs<span class="w"> </span>quickshop-backend
</code></pre>
</div></li>
<li><p><strong>Verify webhook is accessible from internet</strong>:</p>

<ul>
<li>Visit your GitHub webhook settings page</li>
<li>Check the "Recent Deliveries" section</li>
<li>Red indicator means failure, green means success</li>
</ul></li>
<li><p><strong>Setup deployment monitoring</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="c1"># Create a monitoring script</span>
nano<span class="w"> </span>~/deployment-monitor.sh
</code></pre>
</div>

<p><strong>Content for deployment-monitor.sh</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># QuickShop deployment monitoring script</span>
<span class="nv">LOG_FILE</span><span class="o">=</span><span class="s2">&quot;/home/ubuntu/quickshop/logs/monitoring.log&quot;</span>

log<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;[</span><span class="k">$(</span>date<span class="w"> </span><span class="s1">&#39;+%Y-%m-%d %H:%M:%S&#39;</span><span class="k">)</span><span class="s2">] </span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$LOG_FILE</span><span class="s2">&quot;</span>
<span class="o">}</span>

<span class="c1"># Check backend status</span>
<span class="nv">BACKEND_STATUS</span><span class="o">=</span><span class="k">$(</span>curl<span class="w"> </span>-s<span class="w"> </span>-o<span class="w"> </span>/dev/null<span class="w"> </span>-w<span class="w"> </span><span class="s2">&quot;%{http_code}&quot;</span><span class="w"> </span>https://quickshop.echelonxventures.org/api/health<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;000&quot;</span><span class="k">)</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$BACKEND_STATUS</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;200&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span>log<span class="w"> </span><span class="s2">&quot; Backend OK: </span><span class="nv">$BACKEND_STATUS</span><span class="s2">&quot;</span>
<span class="k">else</span>
<span class="w">    </span>log<span class="w"> </span><span class="s2">&quot; Backend Error: </span><span class="nv">$BACKEND_STATUS</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="c1"># Optionally restart backend</span>
<span class="w">    </span><span class="c1"># pm2 restart quickshop-backend</span>
<span class="k">fi</span>

<span class="c1"># Check webhook status</span>
<span class="nv">WEBHOOK_STATUS</span><span class="o">=</span><span class="k">$(</span>curl<span class="w"> </span>-s<span class="w"> </span>-o<span class="w"> </span>/dev/null<span class="w"> </span>-w<span class="w"> </span><span class="s2">&quot;%{http_code}&quot;</span><span class="w"> </span>http://quickshop.echelonxventures.org:9000/health<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;000&quot;</span><span class="k">)</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$WEBHOOK_STATUS</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;200&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span>log<span class="w"> </span><span class="s2">&quot; Webhook OK: </span><span class="nv">$WEBHOOK_STATUS</span><span class="s2">&quot;</span>
<span class="k">else</span>
<span class="w">    </span>log<span class="w"> </span><span class="s2">&quot; Webhook Error: </span><span class="nv">$WEBHOOK_STATUS</span><span class="s2">&quot;</span>
<span class="k">fi</span>

<span class="c1"># Check if PM2 processes are running</span>
<span class="nv">RUNNING_APPS</span><span class="o">=</span><span class="k">$(</span>pm2<span class="w"> </span>jlist<span class="w"> </span><span class="p">|</span><span class="w"> </span>jq<span class="w"> </span>-r<span class="w"> </span><span class="s1">&#39;.[] | select(.pm2_env.status == &quot;online&quot;) | .name&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>wc<span class="w"> </span>-l<span class="k">)</span>
<span class="nv">TOTAL_APPS</span><span class="o">=</span><span class="k">$(</span>pm2<span class="w"> </span>jlist<span class="w"> </span><span class="p">|</span><span class="w"> </span>jq<span class="w"> </span><span class="s1">&#39;length&#39;</span><span class="k">)</span>

log<span class="w"> </span><span class="s2">&quot;PM2 Status: </span><span class="nv">$RUNNING_APPS</span><span class="s2">/</span><span class="nv">$TOTAL_APPS</span><span class="s2"> apps running&quot;</span>

<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$RUNNING_APPS</span><span class="s2">&quot;</span><span class="w"> </span>-lt<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$TOTAL_APPS</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span>log<span class="w"> </span><span class="s2">&quot; Some PM2 apps are not running, attempting restart&quot;</span>
<span class="w">    </span>pm2<span class="w"> </span>reload<span class="w"> </span>all
<span class="k">fi</span>
</code></pre>
</div>

<p>Make it executable and add to cron:</p>

<div class="codehilite">
<pre><span></span><code>chmod<span class="w"> </span>+x<span class="w"> </span>~/deployment-monitor.sh

<span class="c1"># Add to crontab to run every 5 minutes</span>
<span class="o">(</span>crontab<span class="w"> </span>-l<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="p">;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;*/5 * * * * /home/ubuntu/deployment-monitor.sh&quot;</span><span class="o">)</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>crontab<span class="w"> </span>-
</code></pre>
</div></li>
<li><p><strong>Common auto-deployment issues and solutions</strong>:</p>

<ul>
<li><strong>Webhook timeout</strong>: Increase the timeout values in the webhook server</li>
<li><strong>Permission errors</strong>: Ensure the deployment user has proper permissions</li>
<li><strong>SSL/TLS issues</strong>: Make sure your webhook URL uses HTTPS</li>
<li><strong>Build failures</strong>: Check the deployment logs for specific errors</li>
<li><strong>Memory issues</strong>: On free tier, ensure you're not exceeding memory limits</li>
</ul></li>
</ol>

<h3 id="89-deploy-a-test-change-to-verify-auto-deployment">8.9 Deploy a Test Change to Verify Auto-Deployment</h3>

<ol>
<li><p><strong>Make a small change to your repository</strong> (from your local machine):</p>

<ul>
<li>Make a minor change to any file in the GitHub repository</li>
<li>Commit and push the change to the main branch</li>
<li>This should trigger the webhook and auto-deployment</li>
</ul></li>
<li><p><strong>Monitor the deployment</strong>:</p>

<ul>
<li>Check GitHub webhook delivery status</li>
<li>Monitor PM2 logs: <code>pm2 logs</code></li>
<li>Check deployment logs: <code>tail -f ~/quickshop/logs/deployment.log</code></li>
<li>Verify the change appears on your live site</li>
</ul></li>
</ol>

<hr />

<h2 id="9-final-integration-9-final-integration">9. Final Integration {#9-final-integration}</h2>

<h3 id="91-complete-system-integration-verification">9.1 Complete System Integration Verification</h3>

<ol>
<li><p><strong>Verify all services are running</strong>:</p>

<div class="codehilite">
<pre><span></span><code>pm2<span class="w"> </span>status
</code></pre>
</div>

<p>You should see both <code>quickshop-backend</code> and <code>quickshop-webhook</code> showing as "online".</p></li>
<li><p><strong>Check backend API health</strong>:</p>

<div class="codehilite">
<pre><span></span><code>curl<span class="w"> </span>-I<span class="w"> </span>https://quickshop.echelonxventures.org/api/health
<span class="c1"># Should return HTTP/1.1 200 OK</span>
</code></pre>
</div></li>
<li><p><strong>Verify full backend functionality</strong>:</p>

<div class="codehilite">
<pre><span></span><code>curl<span class="w"> </span>-s<span class="w"> </span>https://quickshop.echelonxventures.org/api/health
<span class="c1"># Should return: {&quot;status&quot;:&quot;OK&quot;,&quot;timestamp&quot;:&quot;2024-12-05T10:30:00.000Z&quot;}</span>
</code></pre>
</div></li>
<li><p><strong>Check frontend accessibility</strong>:</p>

<div class="codehilite">
<pre><span></span><code>curl<span class="w"> </span>-I<span class="w"> </span>https://quickshop.echelonxventures.org
<span class="c1"># Should return HTTP/1.1 200 OK</span>
</code></pre>
</div></li>
<li><p><strong>Verify different portals are accessible</strong>:</p>

<div class="codehilite">
<pre><span></span><code>curl<span class="w"> </span>-I<span class="w"> </span>https://quickshop.echelonxventures.org/admin
curl<span class="w"> </span>-I<span class="w"> </span>https://quickshop.echelonxventures.org/seller
curl<span class="w"> </span>-I<span class="w"> </span>https://quickshop.echelonxventures.org/support
curl<span class="w"> </span>-I<span class="w"> </span>https://quickshop.echelonxventures.org/analytics
</code></pre>
</div></li>
<li><p><strong>Test API proxy functionality</strong>:</p>

<div class="codehilite">
<pre><span></span><code>curl<span class="w"> </span>-I<span class="w"> </span>https://quickshop.echelonxventures.org/api/
<span class="c1"># Should return 200 or 404 (meaning the proxy is working)</span>
</code></pre>
</div></li>
<li><p><strong>Check webhook server status</strong>:</p>

<div class="codehilite">
<pre><span></span><code>curl<span class="w"> </span>-s<span class="w"> </span>http://quickshop.echelonxventures.org:9000/health
<span class="c1"># Should return: {&quot;status&quot;:&quot;OK&quot;,&quot;timestamp&quot;:&quot;...&quot;,&quot;service&quot;:&quot;Webhook Server&quot;}</span>
</code></pre>
</div></li>
</ol>

<h3 id="92-database-connection-testing">9.2 Database Connection Testing</h3>

<ol>
<li><p><strong>Test database connectivity from backend</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/quickshop/backend
<span class="c1"># Create a test script to verify database connection</span>
nano<span class="w"> </span>test-db-integration.js
</code></pre>
</div>

<p><strong>Content for test-db-integration.js</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;dotenv&#39;</span><span class="p">).</span><span class="nx">config</span><span class="p">();</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">mysql</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;mysql2/promise&#39;</span><span class="p">);</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">dbConfig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">host</span><span class="o">:</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB_HOST</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;10.0.1.23&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">user</span><span class="o">:</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB_USER</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;admin&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">password</span><span class="o">:</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB_PASSWORD</span><span class="p">,</span>
<span class="w">  </span><span class="nx">database</span><span class="o">:</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB_NAME</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;quickshop&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">port</span><span class="o">:</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB_PORT</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">3306</span><span class="p">,</span>
<span class="w">  </span><span class="nx">connectTimeout</span><span class="o">:</span><span class="w"> </span><span class="mf">60000</span><span class="p">,</span>
<span class="w">  </span><span class="nx">acquireTimeout</span><span class="o">:</span><span class="w"> </span><span class="mf">60000</span><span class="p">,</span>
<span class="w">  </span><span class="nx">timeout</span><span class="o">:</span><span class="w"> </span><span class="mf">60000</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">testIntegration</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Testing database integration...&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">mysql</span><span class="p">.</span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">dbConfig</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Test with a real query that validates the schema</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">tables</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">connection</span><span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="s1">&#39;SHOW TABLES&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">` Found </span><span class="si">${</span><span class="nx">tables</span><span class="p">.</span><span class="nx">length</span><span class="si">}</span><span class="sb"> tables in the database`</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Test with a sample query (adjust based on your schema)</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">result</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">connection</span><span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="s1">&#39;SELECT COUNT(*) as count FROM information_schema.tables WHERE table_schema = ?&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DB_NAME</span><span class="p">]);</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">` Database query successful: </span><span class="si">${</span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">result</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>

<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="nx">connection</span><span class="p">.</span><span class="nx">end</span><span class="p">();</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39; Database integration test completed successfully&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39; Database integration test failed:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="nx">testIntegration</span><span class="p">();</span>
</code></pre>
</div></li>
<li><p><strong>Run the database integration test</strong>:</p>

<div class="codehilite">
<pre><span></span><code>npm<span class="w"> </span>install<span class="w"> </span>mysql2<span class="w"> </span>dotenv<span class="w">  </span><span class="c1"># Install dependencies if not present</span>
node<span class="w"> </span>test-db-integration.js
</code></pre>
</div></li>
<li><p><strong>Clean up test file</strong>:</p>

<div class="codehilite">
<pre><span></span><code>rm<span class="w"> </span>test-db-integration.js
</code></pre>
</div></li>
</ol>

<h3 id="93-application-functionality-testing">9.3 Application Functionality Testing</h3>

<ol>
<li><p><strong>Test user registration endpoint</strong> (if available):</p>

<div class="codehilite">
<pre><span></span><code>curl<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span>https://quickshop.echelonxventures.org/api/auth/register<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;email&quot;:&quot;test@quickshop.echelonxventures.org&quot;, &quot;password&quot;:&quot;TestPass123!&quot;, &quot;name&quot;:&quot;Test User&quot;}&#39;</span>
</code></pre>
</div></li>
<li><p><strong>Test product listing endpoint</strong> (if available):</p>

<div class="codehilite">
<pre><span></span><code>curl<span class="w"> </span>-s<span class="w"> </span>https://quickshop.echelonxventures.org/api/products<span class="w"> </span><span class="p">|</span><span class="w"> </span>head<span class="w"> </span>-20
</code></pre>
</div></li>
<li><p><strong>Check SSL certificate validity</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>openssl<span class="w"> </span>s_client<span class="w"> </span>-connect<span class="w"> </span>quickshop.echelonxventures.org:443<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="p">|</span><span class="w"> </span>openssl<span class="w"> </span>x509<span class="w"> </span>-noout<span class="w"> </span>-dates
</code></pre>
</div></li>
<li><p><strong>Test HTTP to HTTPS redirect</strong>:</p>

<div class="codehilite">
<pre><span></span><code>curl<span class="w"> </span>-I<span class="w"> </span>http://quickshop.echelonxventures.org
<span class="c1"># Should return: HTTP/1.1 301 Moved Permanently with Location: https://...</span>
</code></pre>
</div></li>
</ol>

<h3 id="94-performance-optimization-and-security-verification">9.4 Performance Optimization and Security Verification</h3>

<ol>
<li><p><strong>Enable and configure advanced NGINX caching</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>nano<span class="w"> </span>/etc/nginx/sites-available/quickshop
</code></pre>
</div>

<p>Update the server configuration with comprehensive caching:</p>

<div class="codehilite">
<pre><span></span><code><span class="c1"># Add these at the top of the file to create a cache zone</span>
<span class="k">proxy_cache_path</span><span class="w"> </span><span class="s">/var/cache/nginx</span><span class="w"> </span><span class="s">levels=1:2</span><span class="w"> </span><span class="s">keys_zone=STATIC_CACHE:10m</span><span class="w"> </span><span class="s">max_size=1g</span><span class="w"> </span><span class="s">inactive=60m</span><span class="w"> </span><span class="s">use_temp_path=off</span><span class="p">;</span>

<span class="k">server</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">listen</span><span class="w"> </span><span class="mi">443</span><span class="w"> </span><span class="s">ssl</span><span class="w"> </span><span class="s">http2</span><span class="p">;</span>
<span class="w">    </span><span class="kn">server_name</span><span class="w"> </span><span class="s">quickshop.echelonxventures.org</span><span class="w"> </span><span class="s">www.quickshop.echelonxventures.org</span><span class="p">;</span>

<span class="w">    </span><span class="c1"># SSL Configuration (add these if not already present)</span>
<span class="w">    </span><span class="kn">ssl_certificate</span><span class="w"> </span><span class="s">/etc/letsencrypt/live/quickshop.echelonxventures.org/fullchain.pem</span><span class="p">;</span>
<span class="w">    </span><span class="kn">ssl_certificate_key</span><span class="w"> </span><span class="s">/etc/letsencrypt/live/quickshop.echelonxventures.org/privkey.pem</span><span class="p">;</span>
<span class="w">    </span><span class="kn">ssl_trusted_certificate</span><span class="w"> </span><span class="s">/etc/letsencrypt/live/quickshop.echelonxventures.org/chain.pem</span><span class="p">;</span>

<span class="w">    </span><span class="c1"># SSL Security Parameters</span>
<span class="w">    </span><span class="kn">ssl_protocols</span><span class="w"> </span><span class="s">TLSv1.2</span><span class="w"> </span><span class="s">TLSv1.3</span><span class="p">;</span>
<span class="w">    </span><span class="kn">ssl_ciphers</span><span class="w"> </span><span class="s">ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384</span><span class="p">;</span>
<span class="w">    </span><span class="kn">ssl_prefer_server_ciphers</span><span class="w"> </span><span class="no">off</span><span class="p">;</span>
<span class="w">    </span><span class="kn">ssl_session_cache</span><span class="w"> </span><span class="s">shared:SSL:10m</span><span class="p">;</span>
<span class="w">    </span><span class="kn">ssl_session_timeout</span><span class="w"> </span><span class="mi">10m</span><span class="p">;</span>
<span class="w">    </span><span class="kn">ssl_session_tickets</span><span class="w"> </span><span class="no">off</span><span class="p">;</span>

<span class="w">    </span><span class="c1"># HSTS (HTTP Strict Transport Security)</span>
<span class="w">    </span><span class="kn">add_header</span><span class="w"> </span><span class="s">Strict-Transport-Security</span><span class="w"> </span><span class="s">&quot;max-age=31536000</span><span class="p">;</span><span class="w"> </span><span class="kn">includeSubDomains&quot;</span><span class="w"> </span><span class="s">always</span><span class="p">;</span>

<span class="w">    </span><span class="c1"># Security headers</span>
<span class="w">    </span><span class="kn">add_header</span><span class="w"> </span><span class="s">X-Frame-Options</span><span class="w"> </span><span class="s">&quot;SAMEORIGIN&quot;</span><span class="w"> </span><span class="s">always</span><span class="p">;</span>
<span class="w">    </span><span class="kn">add_header</span><span class="w"> </span><span class="s">X-XSS-Protection</span><span class="w"> </span><span class="s">&quot;1</span><span class="p">;</span><span class="w"> </span><span class="kn">mode=block&quot;</span><span class="w"> </span><span class="s">always</span><span class="p">;</span>
<span class="w">    </span><span class="kn">add_header</span><span class="w"> </span><span class="s">X-Content-Type-Options</span><span class="w"> </span><span class="s">&quot;nosniff&quot;</span><span class="w"> </span><span class="s">always</span><span class="p">;</span>
<span class="w">    </span><span class="kn">add_header</span><span class="w"> </span><span class="s">Referrer-Policy</span><span class="w"> </span><span class="s">&quot;no-referrer-when-downgrade&quot;</span><span class="w"> </span><span class="s">always</span><span class="p">;</span>
<span class="w">    </span><span class="kn">add_header</span><span class="w"> </span><span class="s">Content-Security-Policy</span><span class="w"> </span><span class="s">&quot;default-src</span><span class="w"> </span><span class="s">&#39;self&#39;</span><span class="w"> </span><span class="s">http:</span><span class="w"> </span><span class="s">https:</span><span class="w"> </span><span class="s">data:</span><span class="w"> </span><span class="s">blob:</span><span class="w"> </span><span class="s">&#39;unsafe-inline&#39;&quot;</span><span class="w"> </span><span class="s">always</span><span class="p">;</span>

<span class="w">    </span><span class="c1"># Client max body size for file uploads</span>
<span class="w">    </span><span class="kn">client_max_body_size</span><span class="w"> </span><span class="s">10M</span><span class="p">;</span>

<span class="w">    </span><span class="c1"># Gzip compression for better performance</span>
<span class="w">    </span><span class="kn">gzip</span><span class="w"> </span><span class="no">on</span><span class="p">;</span>
<span class="w">    </span><span class="kn">gzip_vary</span><span class="w"> </span><span class="no">on</span><span class="p">;</span>
<span class="w">    </span><span class="kn">gzip_min_length</span><span class="w"> </span><span class="mi">1024</span><span class="p">;</span>
<span class="w">    </span><span class="kn">gzip_types</span><span class="w"> </span><span class="s">text/plain</span><span class="w"> </span><span class="s">text/css</span><span class="w"> </span><span class="s">application/json</span><span class="w"> </span><span class="s">application/javascript</span><span class="w"> </span><span class="s">text/xml</span><span class="w"> </span><span class="s">application/xml</span><span class="w"> </span><span class="s">application/xml+rss</span><span class="w"> </span><span class="s">text/javascript</span><span class="p">;</span>

<span class="w">    </span><span class="c1"># Cache for static files</span>
<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="p">~</span><span class="sr">*</span><span class="w"> </span><span class="s">\.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)</span>$<span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kn">expires</span><span class="w"> </span><span class="s">1y</span><span class="p">;</span>
<span class="w">        </span><span class="kn">add_header</span><span class="w"> </span><span class="s">Cache-Control</span><span class="w"> </span><span class="s">&quot;public,</span><span class="w"> </span><span class="s">immutable&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="kn">gzip_static</span><span class="w"> </span><span class="no">on</span><span class="p">;</span>
<span class="w">        </span><span class="kn">etag</span><span class="w"> </span><span class="no">on</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1"># Main frontend application (customer-facing)</span>
<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kn">alias</span><span class="w"> </span><span class="s">/home/ubuntu/quickshop/frontend/build/</span><span class="p">;</span>
<span class="w">        </span><span class="kn">try_files</span><span class="w"> </span><span class="nv">$uri</span><span class="w"> </span><span class="nv">$uri/</span><span class="w"> </span><span class="s">@fallback</span><span class="p">;</span>
<span class="w">        </span><span class="kn">expires</span><span class="w"> </span><span class="s">1h</span><span class="p">;</span>
<span class="w">        </span><span class="kn">add_header</span><span class="w"> </span><span class="s">Cache-Control</span><span class="w"> </span><span class="s">&quot;public,</span><span class="w"> </span><span class="s">must-revalidate&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1"># Fallback for Single Page Application routing</span>
<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">@fallback</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kn">alias</span><span class="w"> </span><span class="s">/home/ubuntu/quickshop/frontend/build/index.html</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1"># API proxy to backend</span>
<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/api</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="s">http://localhost:5000</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_http_version</span><span class="w"> </span><span class="mi">1</span><span class="s">.1</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">Upgrade</span><span class="w"> </span><span class="nv">$http_upgrade</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">Connection</span><span class="w"> </span><span class="s">&#39;upgrade&#39;</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">Host</span><span class="w"> </span><span class="nv">$host</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Real-IP</span><span class="w"> </span><span class="nv">$remote_addr</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Forwarded-For</span><span class="w"> </span><span class="nv">$proxy_add_x_forwarded_for</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Forwarded-Proto</span><span class="w"> </span><span class="nv">$scheme</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_cache_bypass</span><span class="w"> </span><span class="nv">$http_upgrade</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_connect_timeout</span><span class="w"> </span><span class="s">60s</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_send_timeout</span><span class="w"> </span><span class="s">60s</span><span class="p">;</span>
<span class="w">        </span><span class="kn">proxy_read_timeout</span><span class="w"> </span><span class="s">60s</span><span class="p">;</span>

<span class="w">        </span><span class="c1"># Security: Prevent direct access to sensitive backend paths</span>
<span class="w">        </span><span class="kn">proxy_redirect</span><span class="w"> </span><span class="no">off</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1"># Admin portal</span>
<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/admin</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kn">alias</span><span class="w"> </span><span class="s">/home/ubuntu/quickshop/admin_portal/build/</span><span class="p">;</span>
<span class="w">        </span><span class="kn">try_files</span><span class="w"> </span><span class="nv">$uri</span><span class="w"> </span><span class="nv">$uri/</span><span class="w"> </span><span class="s">@admin_fallback</span><span class="p">;</span>
<span class="w">        </span><span class="kn">expires</span><span class="w"> </span><span class="s">1h</span><span class="p">;</span>
<span class="w">        </span><span class="kn">add_header</span><span class="w"> </span><span class="s">Cache-Control</span><span class="w"> </span><span class="s">&quot;public,</span><span class="w"> </span><span class="s">must-revalidate&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">@admin_fallback</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kn">alias</span><span class="w"> </span><span class="s">/home/ubuntu/quickshop/admin_portal/build/index.html</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1"># Seller portal</span>
<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/seller</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kn">alias</span><span class="w"> </span><span class="s">/home/ubuntu/quickshop/seller_portal/build/</span><span class="p">;</span>
<span class="w">        </span><span class="kn">try_files</span><span class="w"> </span><span class="nv">$uri</span><span class="w"> </span><span class="nv">$uri/</span><span class="w"> </span><span class="s">@seller_fallback</span><span class="p">;</span>
<span class="w">        </span><span class="kn">expires</span><span class="w"> </span><span class="s">1h</span><span class="p">;</span>
<span class="w">        </span><span class="kn">add_header</span><span class="w"> </span><span class="s">Cache-Control</span><span class="w"> </span><span class="s">&quot;public,</span><span class="w"> </span><span class="s">must-revalidate&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">@seller_fallback</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kn">alias</span><span class="w"> </span><span class="s">/home/ubuntu/quickshop/seller_portal/build/index.html</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1"># Support portal</span>
<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/support</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kn">alias</span><span class="w"> </span><span class="s">/home/ubuntu/quickshop/support_portal/build/</span><span class="p">;</span>
<span class="w">        </span><span class="kn">try_files</span><span class="w"> </span><span class="nv">$uri</span><span class="w"> </span><span class="nv">$uri/</span><span class="w"> </span><span class="s">@support_fallback</span><span class="p">;</span>
<span class="w">        </span><span class="kn">expires</span><span class="w"> </span><span class="s">1h</span><span class="p">;</span>
<span class="w">        </span><span class="kn">add_header</span><span class="w"> </span><span class="s">Cache-Control</span><span class="w"> </span><span class="s">&quot;public,</span><span class="w"> </span><span class="s">must-revalidate&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">@support_fallback</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kn">alias</span><span class="w"> </span><span class="s">/home/ubuntu/quickshop/support_portal/build/index.html</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1"># Analytics portal</span>
<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/analytics</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kn">alias</span><span class="w"> </span><span class="s">/home/ubuntu/quickshop/analytics_portal/build/</span><span class="p">;</span>
<span class="w">        </span><span class="kn">try_files</span><span class="w"> </span><span class="nv">$uri</span><span class="w"> </span><span class="nv">$uri/</span><span class="w"> </span><span class="s">@analytics_fallback</span><span class="p">;</span>
<span class="w">        </span><span class="kn">expires</span><span class="w"> </span><span class="s">1h</span><span class="p">;</span>
<span class="w">        </span><span class="kn">add_header</span><span class="w"> </span><span class="s">Cache-Control</span><span class="w"> </span><span class="s">&quot;public,</span><span class="w"> </span><span class="s">must-revalidate&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">@analytics_fallback</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kn">alias</span><span class="w"> </span><span class="s">/home/ubuntu/quickshop/analytics_portal/build/index.html</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1"># Logging</span>
<span class="w">    </span><span class="kn">access_log</span><span class="w"> </span><span class="s">/var/log/nginx/quickshop_access.log</span><span class="p">;</span>
<span class="w">    </span><span class="kn">error_log</span><span class="w"> </span><span class="s">/var/log/nginx/quickshop_error.log</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1"># Redirect HTTP to HTTPS</span>
<span class="k">server</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">listen</span><span class="w"> </span><span class="mi">80</span><span class="p">;</span>
<span class="w">    </span><span class="kn">server_name</span><span class="w"> </span><span class="s">quickshop.echelonxventures.org</span><span class="w"> </span><span class="s">www.quickshop.echelonxventures.org</span><span class="p">;</span>
<span class="w">    </span><span class="kn">return</span><span class="w"> </span><span class="mi">301</span><span class="w"> </span><span class="s">https://</span><span class="nv">$server_name$request_uri</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div></li>
<li><p><strong>Test the updated NGINX configuration</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>nginx<span class="w"> </span>-t
</code></pre>
</div></li>
<li><p><strong>Reload NGINX with new configuration</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>reload<span class="w"> </span>nginx
</code></pre>
</div></li>
</ol>

<h3 id="95-comprehensive-security-checks">9.5 Comprehensive Security Checks</h3>

<ol>
<li><p><strong>Run security headers check</strong>:</p>

<div class="codehilite">
<pre><span></span><code>curl<span class="w"> </span>-I<span class="w"> </span>https://quickshop.echelonxventures.org<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;strict-transport-security\|x-frame-options\|x-xss-protection\|x-content-type-options&quot;</span>
</code></pre>
</div>

<p>You should see the security headers we configured.</p></li>
<li><p><strong>Test security with online tools</strong>:</p>

<ul>
<li>Visit <a href="https://observatory.mozilla.org/">Mozilla Observatory</a></li>
<li>Enter <code>quickshop.echelonxventures.org</code></li>
<li>Review security rating and recommendations</li>
</ul></li>
<li><p><strong>Check for common security issues</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="c1"># Check if sensitive files are accessible</span>
curl<span class="w"> </span>-I<span class="w"> </span>https://quickshop.echelonxventures.org/.env
curl<span class="w"> </span>-I<span class="w"> </span>https://quickshop.echelonxventures.org/.git/
<span class="c1"># Should return 404 or 403 for both</span>
</code></pre>
</div></li>
</ol>

<h3 id="96-load-testing-preparation">9.6 Load Testing Preparation</h3>

<ol>
<li><p><strong>Set up basic monitoring</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="c1"># Install additional monitoring tools</span>
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>htop<span class="w"> </span>iotop<span class="w"> </span>nethogs<span class="w"> </span>-y
</code></pre>
</div></li>
<li><p><strong>Create a simple load test script</strong> (optional):</p>

<div class="codehilite">
<pre><span></span><code>nano<span class="w"> </span>~/load-test.sh
</code></pre>
</div>

<p><strong>Content for load-test.sh</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="ch">#!/bin/bash</span>
<span class="c1"># Simple load test script for QuickShop</span>

<span class="nv">URL</span><span class="o">=</span><span class="s2">&quot;https://quickshop.echelonxventures.org&quot;</span>
<span class="nv">DURATION</span><span class="o">=</span><span class="m">30</span><span class="w">  </span><span class="c1"># seconds</span>
<span class="nv">CONCURRENCY</span><span class="o">=</span><span class="m">5</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Starting load test for </span><span class="nv">$DURATION</span><span class="s2"> seconds with </span><span class="nv">$CONCURRENCY</span><span class="s2"> concurrent requests...&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Testing URL: </span><span class="nv">$URL</span><span class="s2">&quot;</span>

<span class="c1"># Install Apache Bench if not present</span>
<span class="k">if</span><span class="w"> </span>!<span class="w"> </span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span>ab<span class="w"> </span><span class="p">&amp;</span>&gt;<span class="w"> </span>/dev/null<span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>apache2-utils<span class="w"> </span>-y
<span class="k">fi</span>

<span class="c1"># Run the load test</span>
ab<span class="w"> </span>-n<span class="w"> </span><span class="k">$((</span><span class="nv">CONCURRENCY</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">20</span><span class="k">))</span><span class="w"> </span>-c<span class="w"> </span><span class="nv">$CONCURRENCY</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$URL</span><span class="s2">/&quot;</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Load test completed.&quot;</span>
</code></pre>
</div>

<p>Make it executable:</p>

<div class="codehilite">
<pre><span></span><code>chmod<span class="w"> </span>+x<span class="w"> </span>~/load-test.sh
</code></pre>
</div></li>
</ol>

<h3 id="97-final-health-check-and-monitoring-setup">9.7 Final Health Check and Monitoring Setup</h3>

<ol>
<li><p><strong>Set up basic monitoring with a health check script</strong>:</p>

<div class="codehilite">
<pre><span></span><code>nano<span class="w"> </span>~/full-health-check.sh
</code></pre>
</div>

<p><strong>Content for full-health-check.sh</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="ch">#!/bin/bash</span>
<span class="c1"># Comprehensive health check for QuickShop deployment</span>

<span class="nv">TIMESTAMP</span><span class="o">=</span><span class="k">$(</span>date<span class="w"> </span><span class="s1">&#39;+%Y-%m-%d %H:%M:%S&#39;</span><span class="k">)</span>
<span class="nv">LOG_FILE</span><span class="o">=</span><span class="s2">&quot;/home/ubuntu/quickshop/logs/full-health-check.log&quot;</span>

log<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;[</span><span class="nv">$TIMESTAMP</span><span class="s2">] </span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$LOG_FILE</span><span class="s2">&quot;</span>
<span class="o">}</span>

log<span class="w"> </span><span class="s2">&quot;=== Starting Full Health Check ===&quot;</span>

<span class="c1"># Check PM2 services</span>
log<span class="w"> </span><span class="s2">&quot;Checking PM2 services...&quot;</span>
<span class="nv">PM2_STATUS</span><span class="o">=</span><span class="k">$(</span>pm2<span class="w"> </span>jlist<span class="w"> </span><span class="p">|</span><span class="w"> </span>jq<span class="w"> </span>-r<span class="w"> </span><span class="s1">&#39;.[].pm2_env.status&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span><span class="p">|</span><span class="w"> </span>uniq<span class="w"> </span><span class="p">|</span><span class="w"> </span>tr<span class="w"> </span><span class="s1">&#39;\n&#39;</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="k">)</span>
log<span class="w"> </span><span class="s2">&quot;PM2 Status: </span><span class="nv">$PM2_STATUS</span><span class="s2">&quot;</span>

<span class="c1"># Check backend health</span>
<span class="nv">BACKEND_STATUS</span><span class="o">=</span><span class="k">$(</span>curl<span class="w"> </span>-s<span class="w"> </span>-o<span class="w"> </span>/dev/null<span class="w"> </span>-w<span class="w"> </span><span class="s2">&quot;%{http_code}&quot;</span><span class="w"> </span>https://quickshop.echelonxventures.org/api/health<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;000&quot;</span><span class="k">)</span>
log<span class="w"> </span><span class="s2">&quot;Backend Status: </span><span class="nv">$BACKEND_STATUS</span><span class="s2">&quot;</span>

<span class="c1"># Check frontend accessibility</span>
<span class="nv">FRONTEND_STATUS</span><span class="o">=</span><span class="k">$(</span>curl<span class="w"> </span>-s<span class="w"> </span>-o<span class="w"> </span>/dev/null<span class="w"> </span>-w<span class="w"> </span><span class="s2">&quot;%{http_code}&quot;</span><span class="w"> </span>https://quickshop.echelonxventures.org<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;000&quot;</span><span class="k">)</span>
log<span class="w"> </span><span class="s2">&quot;Frontend Status: </span><span class="nv">$FRONTEND_STATUS</span><span class="s2">&quot;</span>

<span class="c1"># Check webhook server</span>
<span class="nv">WEBHOOK_STATUS</span><span class="o">=</span><span class="k">$(</span>curl<span class="w"> </span>-s<span class="w"> </span>-o<span class="w"> </span>/dev/null<span class="w"> </span>-w<span class="w"> </span><span class="s2">&quot;%{http_code}&quot;</span><span class="w"> </span>http://quickshop.echelonxventures.org:9000/health<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;000&quot;</span><span class="k">)</span>
log<span class="w"> </span><span class="s2">&quot;Webhook Status: </span><span class="nv">$WEBHOOK_STATUS</span><span class="s2">&quot;</span>

<span class="c1"># Check SSL certificate</span>
<span class="nv">SSL_EXPIRY</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>openssl<span class="w"> </span>s_client<span class="w"> </span>-connect<span class="w"> </span>quickshop.echelonxventures.org:443<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="p">|</span><span class="w"> </span>openssl<span class="w"> </span>x509<span class="w"> </span>-noout<span class="w"> </span>-enddate<span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-d<span class="o">=</span><span class="w"> </span>-f2<span class="k">)</span>
log<span class="w"> </span><span class="s2">&quot;SSL Certificate Expiry: </span><span class="nv">$SSL_EXPIRY</span><span class="s2">&quot;</span>

<span class="c1"># Check system resources</span>
<span class="nv">MEMORY_USAGE</span><span class="o">=</span><span class="k">$(</span>free<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>Mem<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{printf &quot;%.2f%%&quot;, $3/$2 * 100.0}&#39;</span><span class="k">)</span>
<span class="nv">DISK_USAGE</span><span class="o">=</span><span class="k">$(</span>df<span class="w"> </span>-h<span class="w"> </span>/<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;NR==2 {print $5}&#39;</span><span class="k">)</span>
log<span class="w"> </span><span class="s2">&quot;Memory Usage: </span><span class="nv">$MEMORY_USAGE</span><span class="s2">&quot;</span>
log<span class="w"> </span><span class="s2">&quot;Disk Usage: </span><span class="nv">$DISK_USAGE</span><span class="s2">&quot;</span>

<span class="c1"># Summary</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$BACKEND_STATUS</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;200&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$FRONTEND_STATUS</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;200&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span>log<span class="w"> </span><span class="s2">&quot; Overall status: HEALTHY&quot;</span>
<span class="k">else</span>
<span class="w">    </span>log<span class="w"> </span><span class="s2">&quot; Overall status: ISSUES DETECTED&quot;</span>
<span class="k">fi</span>

log<span class="w"> </span><span class="s2">&quot;=== Health Check Complete ===&quot;</span>
log<span class="w"> </span><span class="s2">&quot;&quot;</span>
</code></pre>
</div>

<p>Make it executable:</p>

<div class="codehilite">
<pre><span></span><code>chmod<span class="w"> </span>+x<span class="w"> </span>~/full-health-check.sh
</code></pre>
</div></li>
<li><p><strong>Run the full health check</strong>:</p>

<div class="codehilite">
<pre><span></span><code>~/full-health-check.sh
</code></pre>
</div></li>
<li><p><strong>Set up automated health checks</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="c1"># Add to crontab to run every 10 minutes</span>
<span class="o">(</span>crontab<span class="w"> </span>-l<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="p">;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;*/10 * * * * /home/ubuntu/full-health-check.sh&quot;</span><span class="o">)</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>crontab<span class="w"> </span>-
</code></pre>
</div></li>
</ol>

<h3 id="98-documentation-and-final-verification">9.8 Documentation and Final Verification</h3>

<ol>
<li><p><strong>Verify all environment variables are properly configured</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="c1"># Check backend environment</span>
<span class="nb">cd</span><span class="w"> </span>~/quickshop/backend
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Backend configuration check:&quot;</span>
grep<span class="w"> </span>-E<span class="w"> </span><span class="s2">&quot;^(NODE_ENV|DB_HOST|DB_USER|APP_URL)&quot;</span><span class="w"> </span>.env
</code></pre>
</div></li>
<li><p><strong>Verify SSL certificate is properly configured</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>certbot<span class="w"> </span>certificates
</code></pre>
</div></li>
<li><p><strong>Check that auto-renewal is properly configured</strong>:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>crontab<span class="w"> </span>-l
</code></pre>
</div></li>
<li><p><strong>Verify webhook secret is properly set</strong>:</p>

<div class="codehilite">
<pre><span></span><code>printenv<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>WEBHOOK_SECRET
</code></pre>
</div></li>
<li><p><strong>Document the deployment</strong> by creating a status file:</p>

<div class="codehilite">
<pre><span></span><code>cat<span class="w"> </span>&gt;<span class="w"> </span>~/quickshop/DEPLOYMENT_STATUS.md<span class="w"> </span><span class="s">&lt;&lt; EOF</span>
<span class="s"># QuickShop Deployment Status</span>

<span class="s">**Deployment Date**: $(date)</span>
<span class="s">**Environment**: Production</span>
<span class="s">**Domain**: https://quickshop.echelonxventures.org</span>

<span class="s">## Services Status</span>
<span class="s">- Backend API: $(curl -s -o /dev/null -w &quot;%{http_code}&quot; https://quickshop.echelonxventures.org/api/health 2&gt;/dev/null || echo &quot;DOWN&quot;)</span>
<span class="s">- Frontend: $(curl -s -o /dev/null -w &quot;%{http_code}&quot; https://quickshop.echelonxventures.org 2&gt;/dev/null || echo &quot;DOWN&quot;)</span>
<span class="s">- Webhook: $(curl -s -o /dev/null -w &quot;%{http_code}&quot; http://quickshop.echelonxventures.org:9000/health 2&gt;/dev/null || echo &quot;DOWN&quot;)</span>

<span class="s">## SSL Certificate</span>
<span class="s">- Status: Valid</span>
<span class="s">- Expiry: $(echo | openssl s_client -connect quickshop.echelonxventures.org:443 2&gt;/dev/null | openssl x509 -noout -enddate | cut -d= -f2)</span>

<span class="s">## Auto-deployment</span>
<span class="s">- Status: Configured</span>
<span class="s">- Webhook URL: https://quickshop.echelonxventures.org:9000/webhook</span>

<span class="s">## Backup Strategy</span>
<span class="s">- Automatic: Daily backups (if configured)</span>
<span class="s">- Manual: Available in /home/ubuntu/quickshop-backups/</span>

<span class="s">**Deployed by**: Ubuntu User</span>
<span class="s">**Contact**: admin@quickshop.echelonxventures.org</span>
<span class="s">EOF</span>
</code></pre>
</div></li>
</ol>

<h3 id="99-final-deployment-validation-checklist">9.9 Final Deployment Validation Checklist</h3>

<p>Verify that all components are working properly:</p>

<ul>
<li>[ ] <strong>Domain</strong>: <code>quickshop.echelonxventures.org</code> resolves to <code>141.148.196.251</code></li>
<li>[ ] <strong>SSL Certificate</strong>: Valid and auto-renewal configured</li>
<li>[ ] <strong>Backend</strong>: Running on port 5000, accessible via API proxy</li>
<li>[ ] <strong>Frontend</strong>: Served via NGINX, accessible at root domain</li>
<li>[ ] <strong>Admin Portal</strong>: Accessible at <code>/admin</code> path</li>
<li>[ ] <strong>Database</strong>: OCI MySQL Heatwave connected and functional</li>
<li>[ ] <strong>Webhook</strong>: Running on port 9000, accepting GitHub pushes</li>
<li>[ ] <strong>Auto-deployment</strong>: Working with successful test deployment</li>
<li>[ ] <strong>Security</strong>: All recommended headers and protections in place</li>
<li>[ ] <strong>Monitoring</strong>: Health checks and logs properly configured</li>
<li>[ ] <strong>Backup</strong>: Backup system properly implemented</li>
</ul>

<p>Congratulations! Your QuickShop e-commerce platform is now fully deployed and operational with all required features and automatic deployment capabilities.</p>

<hr />

<h2 id="10-resources-10-resources">10. Resources {#10-resources}</h2>

<h3 id="101-helpful-links">10.1 Helpful Links</h3>

<ul>
<li><a href="https://docs.oracle.com/en-us/iaas/Content/home.htm">Oracle Cloud Infrastructure Documentation</a></li>
<li><a href="https://github.com/echelonxventures/quickshop.git">QuickShop GitHub Repository</a></li>
<li><a href="https://nginx.org/en/docs/">NGINX Configuration Guide</a></li>
<li><a href="https://pm2.keymetrics.io/docs/usage/quick-start/">PM2 Process Manager</a></li>
<li><a href="https://letsencrypt.org/docs/">Let's Encrypt SSL Documentation</a></li>
<li><a href="https://nodejs.org/docs/">Node.js Documentation</a></li>
<li><a href="https://dev.mysql.com/doc/refman/8.0/en/">MySQL 8.0 Reference Manual</a></li>
<li><a href="https://docs.github.com/en/webhooks">GitHub Webhooks Guide</a></li>
<li><a href="https://ubuntu.com/server/docs">Ubuntu Server Guide</a></li>
</ul>

<h3 id="102-troubleshooting">10.2 Troubleshooting</h3>

<p><strong>Common Issues and Solutions</strong>:</p>

<ol>
<li><p><strong>SSL Certificate Issues</strong>:</p>

<ul>
<li>Verify domain DNS points to correct IP</li>
<li>Check firewall rules allow port 80/443</li>
<li>Test with <code>sudo certbot renew --dry-run</code></li>
</ul></li>
<li><p><strong>Backend Not Starting</strong>:</p>

<ul>
<li>Check PM2 logs: <code>pm2 logs</code></li>
<li>Verify environment variables: <code>pm2 env quickshop-backend</code></li>
<li>Check database connectivity</li>
</ul></li>
<li><p><strong>Frontend Build Issues</strong>:</p>

<ul>
<li>Ensure Node.js and npm are installed correctly</li>
<li>Clear npm cache: <code>npm cache clean --force</code></li>
<li>Rebuild: <code>npm run build</code></li>
</ul></li>
<li><p><strong>GitHub Webhook Not Triggering</strong>:</p>

<ul>
<li>Verify webhook URL is accessible</li>
<li>Check firewall allows port 9000</li>
<li>Verify webhook secret matches</li>
</ul></li>
<li><p><strong>OCI Network Issues</strong>:</p>

<ul>
<li>Verify Security List rules allow necessary traffic</li>
<li>Check that the instance is in the correct subnet</li>
<li>Confirm route tables have required gateways</li>
</ul></li>
<li><p><strong>Database Connection Issues</strong>:</p>

<ul>
<li>Verify the MySQL instance is running and accessible</li>
<li>Check that the security rules in the private subnet allow database connections</li>
<li>Confirm the connection string is correctly formatted</li>
</ul></li>
<li><p><strong>Auto-deployment Failures</strong>:</p>

<ul>
<li>Check webhook server logs: <code>pm2 logs quickshop-webhook</code></li>
<li>Verify the webhook secret matches between GitHub and server</li>
<li>Confirm deployment script has proper execute permissions</li>
</ul></li>
</ol>

<h3 id="103-maintenance-commands">10.3 Maintenance Commands</h3>

<div class="codehilite">
<pre><span></span><code><span class="c1"># View application logs</span>
pm2<span class="w"> </span>logs

<span class="c1"># Restart all processes</span>
pm2<span class="w"> </span>restart<span class="w"> </span>all

<span class="c1"># Monitor resource usage</span>
pm2<span class="w"> </span>monit

<span class="c1"># View system information</span>
pm2<span class="w"> </span>info

<span class="c1"># Update certificates</span>
sudo<span class="w"> </span>certbot<span class="w"> </span>renew

<span class="c1"># Check NGINX configuration</span>
sudo<span class="w"> </span>nginx<span class="w"> </span>-t

<span class="c1"># Reload NGINX</span>
sudo<span class="w"> </span>systemctl<span class="w"> </span>reload<span class="w"> </span>nginx

<span class="c1"># Check system resources</span>
htop

<span class="c1"># Check disk usage</span>
df<span class="w"> </span>-h

<span class="c1"># Check memory usage</span>
free<span class="w"> </span>-h

<span class="c1"># Check running processes</span>
ps<span class="w"> </span>aux<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-E<span class="w"> </span><span class="s2">&quot;(node|nginx|pm2)&quot;</span>

<span class="c1"># Check listening ports</span>
sudo<span class="w"> </span>netstat<span class="w"> </span>-tlnp

<span class="c1"># View application status</span>
pm2<span class="w"> </span>status

<span class="c1"># Check specific application logs</span>
pm2<span class="w"> </span>logs<span class="w"> </span>quickshop-backend<span class="w"> </span>--lines<span class="w"> </span><span class="m">50</span>
pm2<span class="w"> </span>logs<span class="w"> </span>quickshop-webhook<span class="w"> </span>--lines<span class="w"> </span><span class="m">50</span>

<span class="c1"># Check NGINX logs</span>
sudo<span class="w"> </span>tail<span class="w"> </span>-f<span class="w"> </span>/var/log/nginx/quickshop_access.log
sudo<span class="w"> </span>tail<span class="w"> </span>-f<span class="w"> </span>/var/log/nginx/quickshop_error.log

<span class="c1"># Check deployment logs</span>
tail<span class="w"> </span>-f<span class="w"> </span>/home/ubuntu/quickshop/logs/deployment.log
tail<span class="w"> </span>-f<span class="w"> </span>/home/ubuntu/quickshop/logs/webhook.log
</code></pre>
</div>

<h3 id="104-performance-monitoring">10.4 Performance Monitoring</h3>

<p><strong>System Resources</strong>:
- <strong>Memory</strong>: Monitor with <code>free -h</code> and <code>htop</code>
- <strong>Disk</strong>: Monitor with <code>df -h</code>
- <strong>CPU</strong>: Monitor with <code>htop</code> or <code>top</code>
- <strong>Network</strong>: Monitor with <code>nethogs</code> or <code>iftop</code></p>

<p><strong>Application Performance</strong>:
- Monitor response times with <code>curl -w "@curl-format.txt" -o /dev/null -s "https://quickshop.echelonxventures.org"</code>
- Monitor error rates in application logs
- Check database query performance</p>

<p><strong>Using PM2 for Monitoring</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="c1"># Real-time monitoring</span>
pm2<span class="w"> </span>monit

<span class="c1"># Detailed process information</span>
pm2<span class="w"> </span>show<span class="w"> </span>quickshop-backend

<span class="c1"># Memory and CPU usage</span>
pm2<span class="w"> </span>top
</code></pre>
</div>

<h3 id="105-security-best-practices">10.5 Security Best Practices</h3>

<ol>
<li><p><strong>Regular Updates</strong>: Keep the system and applications updated:</p>

<div class="codehilite">
<pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sudo<span class="w"> </span>apt<span class="w"> </span>upgrade<span class="w"> </span>-y
</code></pre>
</div></li>
<li><p><strong>SSH Security</strong>:</p>

<ul>
<li>Use SSH keys instead of passwords</li>
<li>Consider changing SSH port and disabling root login</li>
<li>Use fail2ban for additional protection</li>
</ul></li>
<li><p><strong>Database Security</strong>:</p>

<ul>
<li>Regularly update database passwords</li>
<li>Implement database backup strategies</li>
<li>Monitor database access logs</li>
</ul></li>
<li><p><strong>Application Security</strong>:</p>

<ul>
<li>Regularly update dependencies</li>
<li>Monitor application logs for suspicious activity</li>
<li>Implement rate limiting</li>
</ul></li>
<li><p><strong>Network Security</strong>:</p>

<ul>
<li>Keep security lists restrictive</li>
<li>Regularly audit firewall rules</li>
<li>Monitor network traffic</li>
</ul></li>
</ol>

<h3 id="106-backup-and-recovery-strategy">10.6 Backup and Recovery Strategy</h3>

<ol>
<li><p><strong>Application Code Backup</strong>:</p>

<ul>
<li>Automated git commits are part of the deployment process</li>
<li>Manual backups are created during deployments in <code>/home/ubuntu/quickshop-backups/</code></li>
</ul></li>
<li><p><strong>Database Backup</strong>:</p>

<div class="codehilite">
<pre><span></span><code><span class="c1"># Create a database backup</span>
mysqldump<span class="w"> </span>-h<span class="w"> </span><span class="m">10</span>.0.1.23<span class="w"> </span>-u<span class="w"> </span>admin<span class="w"> </span>-p<span class="w"> </span>quickshop<span class="w"> </span><span class="p">|</span><span class="w"> </span>gzip<span class="w"> </span>&gt;<span class="w"> </span>quickshop_backup_<span class="k">$(</span>date<span class="w"> </span>+%Y%m%d_%H%M%S<span class="k">)</span>.sql.gz
</code></pre>
</div></li>
<li><p><strong>Configuration Backup</strong>:</p>

<ul>
<li>Keep copies of critical configuration files</li>
<li>Store environment variables securely</li>
</ul></li>
<li><p><strong>Full System Backup</strong>:</p>

<ul>
<li>OCI provides VM snapshot capabilities</li>
<li>Consider using OCI Object Storage for backup storage</li>
</ul></li>
</ol>

<h3 id="107-scaling-considerations">10.7 Scaling Considerations</h3>

<ol>
<li><p><strong>Vertical Scaling</strong> (for future when outgrowing free tier):</p>

<ul>
<li>Upgrade to larger VM instance shapes</li>
<li>Increase database resources</li>
<li>Expand storage capacity</li>
</ul></li>
<li><p><strong>Horizontal Scaling</strong> (for future growth):</p>

<ul>
<li>Implement load balancer</li>
<li>Add additional application servers</li>
<li>Use database read replicas</li>
<li>Implement caching layers (Redis/Memcached)</li>
</ul></li>
<li><p><strong>Performance Optimizations</strong>:</p>

<ul>
<li>Optimize database queries</li>
<li>Implement CDN for static assets</li>
<li>Use image optimization</li>
<li>Implement advanced caching strategies</li>
</ul></li>
</ol>

<hr />

<p><strong>Congratulations!</strong> You have successfully deployed your QuickShop e-commerce platform on Oracle Cloud Infrastructure. Your application is now live at https://quickshop.echelonxventures.org with automated deployment capabilities.</p>

<p>For any issues during deployment, refer to the troubleshooting section or create an issue on the GitHub repository.</p>

<hr />

<p><em>[QuickShop Deployment Guide - Version 1.0.0 - December 2024]</em></p>

    <div class="footer">
        <p>QuickShop Deployment Guide - Version 1.0.0 - December 2024</p>
        <p> QuickShop Team. All rights reserved.</p>
    </div>
</body>
</html>